"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4031],{54031:function(e,t,n){n.d(t,{Z:function(){return U}});var a,i,r=n(3125),s=n(36112),l=n(6939),o=n(50134),c=n(4399),d=n.n(c),u=n(82256),m=n(66027),f=n(82473),p=n(25494),g=n(18939),v=n.n(g),h=n(70079),b=n(1454),x=n(70671),j=n(32004),w=n(91559),M=n(50829),y=n(33562),I=n(34408),S=n(19841),Z=n(94968),N=n(15420),k=n(37394),C=n(90166),P=n(35250);function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach(function(t){(0,s.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var A=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;function E(e){return e.split(/[\s,]+/)}function R(e){var t=e.value,n=e.onChange,a=e.className,i=(0,x.Z)(),r=(0,h.useState)(""),s=r[0],o=r[1],c=(0,h.useCallback)(function(e){if(s)switch(e.key){case"Enter":case",":case" ":var a=E(s);n([].concat((0,l.Z)(t),(0,l.Z)(a.map(V)))),o(""),e.preventDefault()}},[s,n,t]);return(0,P.jsx)(N.ZP,{className:(0,S.default)("react-select-container",a),isMulti:!0,onBlur:function(e){if(s){var a=E(s);n([].concat((0,l.Z)(t),(0,l.Z)(a.map(V)))),o(s),e.preventDefault()}},classNamePrefix:"react-select",components:B,inputValue:s,isClearable:!0,menuIsOpen:!1,onChange:n,onInputChange:o,onKeyDown:c,placeholder:i.formatMessage(L.placeholder),value:t,"aria-labelledby":"add-emails-label",name:"add-member-emails"})}var V=function(e){return{label:e,value:e,isValid:A.test(e)}},B={DropdownIndicator:function(){return null},IndicatorsContainer:function(){return null},ClearIndicator:function(){return null},MultiValueRemove:function(){return null},MultiValue:function(e){var t=(0,x.Z)(),n=(0,P.jsxs)("span",{className:"flex items-center gap-1",children:[(0,P.jsx)("span",{children:e.children}),(0,P.jsx)(b.q5L,{className:"icon-sm"})]}),a=e.data.isValid?n:(0,P.jsx)(C.u,{label:t.formatMessage(L.tooltipInvalidEmail,{email:e.data.value}),side:"top",children:n});return(0,P.jsx)(k.c.MultiValue,O(O({},e),{},{children:(0,P.jsx)("button",{className:(0,S.default)("m-1 cursor-pointer rounded-full border border-transparent py-1 pl-3 pr-2 text-sm dark:text-gray-300",e.data.isValid?"bg-gray-50 hover:border-gray-300 hover:bg-gray-100 dark:bg-gray-800 dark:hover:border-gray-600 dark:hover:bg-gray-700":"bg-red-200 text-red-500 dark:text-red-500"),onClick:function(t){var n,a;null===(n=(a=e.removeProps).onClick)||void 0===n||n.call(a,t),t.preventDefault()},"aria-label":t.formatMessage(L.removeMember,{member:e.data.value}),children:a})}))}},L=(0,Z.vU)({membersAdded:{id:"emailsTextarea.membersAdded",defaultMessage:"+{count} {count, plural, one {member} other {members}}"},removeMember:{id:"emailsTextarea.removeMember",defaultMessage:"Remove {member}"},tooltipInvalidEmail:{id:"emailsTextarea.tooltipInvalidEmail",defaultMessage:'"{email}" may not be a valid email'},clearAllEntries:{id:"emailsTextarea.clearAllEntries",defaultMessage:"Clear all"},placeholder:{id:"emailsTextarea.placeholder",defaultMessage:"Type an email and press enter..."}}),_=n(998),D=n(44247),F=n(4748),z=n(218);function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach(function(t){(0,s.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function U(e){var t,n,a,c,g,S,Z=e.workspace,N=e.canResendInviteEmails,k=e.onCancel,C=e.cancelButtonText,T=e.onSuccess,O=e.fullWidthButtons,E=void 0!==O&&O,V=Z.isOwnerOfAccount(),B=(0,h.useState)(!1),L=B[0],H=B[1],U=(0,h.useState)(!1),$=U[0],J=U[1],Q=(0,h.useRef)(null),Y=Z.isTeam(),G=(0,x.Z)(),X=(0,h.useState)(!0),ee=X[0],et=X[1],en=(0,h.useState)(!1),ea=en[0],ei=en[1],er=(0,h.useState)(i.INITIAL),es=er[0],el=er[1],eo=(0,h.useState)([]),ec=eo[0],ed=eo[1],eu=(0,h.useState)([]),em=eu[0],ef=eu[1],ep=(t=Z.id,a=(0,x.Z)(),c=(0,f.NL)(),(0,p.D)({mutationFn:(n=(0,o.Z)(d().mark(function e(n){var i,r,s,l,c,u,f,p;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(i=n.emails,r=n.role,s=n.resendEmails,l=[],c=Math.max(5,Math.round(i.length/10)),u=0;u<i.length;u+=c)l.push(i.slice(u,u+c));return f=function(){var e=(0,o.Z)(d().mark(function e(n){return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m.ZP.addWorkspaceUsers(t,n,r,s).then(function(e){return e.errored_emails.length>0&&F.m.danger(a.formatMessage(K.inviteMessageFailure,{emailsStr:e.errored_emails.map(function(e){var t=e.email_address,n=e.error;return"".concat(t,": ").concat(n)}).join(", ")})),e.account_invites}).catch(function(e){throw F.m.danger(e.message),e}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),e.next=7,Promise.all(l.map(function(e){return f(e)}));case 7:return p=e.sent,e.abrupt("return",p.flat());case 9:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)}),onSuccess:function(){c.invalidateQueries({queryKey:["workspace","invites",t]}),null==T||T()}})).mutateAsync,eg=q(V),ev=(g=(0,o.Z)(d().mark(function e(t){var n,a,s;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=null===(n=t.target.files)||void 0===n?void 0:n[0])){e.next=6;break}return e.next=4,function(e,t,n){return new Promise(function(a){if(e.size/1048576>25)a({status:"error",reason:"file_too_large"});else if("text/csv"!==e.type)a({status:"error",reason:"invalid_file_type"});else{var i=new FileReader;i.readAsText(e),i.onload=function(e){var i,s=n,l=(null===(i=e.target)||void 0===i?void 0:i.result).split("\n"),o=new Set;a({status:"success",newRows:l.reduce(function(e,n){var a,i=n.split(",").map(function(e){return e.trim()}),l=(0,r.Z)(i,2),c=l[0],d=l[1];return A.test(c)&&!o.has(c)&&(void 0!==t[d]||s||(s=!0),e.push({email:c,role:null!==(a=t[d])&&void 0!==a?a:t.member})),o.add(c),e},[]),hasWarning:s})}}})}(a,eg,$);case 4:"success"===(s=e.sent).status?(ed(s.newRows),el(i.CSV_TABLE),J(s.hasWarning)):"file_too_large"===s.reason?F.m.danger(G.formatMessage(K.fileTooLargeWarning,{maxSize:"".concat(25,"MB")}),{duration:5}):"invalid_file_type"===s.reason&&F.m.danger(G.formatMessage(K.fileIncorrectTypeWarning),{duration:5});case 6:case"end":return e.stop()}},e)})),function(e){return g.apply(this,arguments)}),eh=function(e,t,n){var a=(0,l.Z)(ec);a[e]=W(W({},a[e]),{},(0,s.Z)({},t,n)),ed(a)},eb=function(e){ed([].concat((0,l.Z)(ec.slice(0,e)),(0,l.Z)(ec.slice(e+1))))},ex=(0,h.useCallback)(function(){ed([]),el(i.INITIAL),ei(!1),ef([])},[]),ej=(S=(0,o.Z)(d().mark(function e(){var t,n;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return ei(!0),e.prev=1,ec.length>5&&F.m.info(G.formatMessage(K.inviteMessageLoading,{numRows:ec.length}),{hasCloseButton:!0}),t=[["admin",u.r3.ADMIN],["owner",u.r3.OWNER],["member",u.r3.STANDARD]],e.next=6,Promise.all(v()(t.map(function(e){var t=(0,r.Z)(e,2),n=t[0],a=t[1],i=ec.filter(function(e){return e.role===n}).map(function(e){return e.email});return i.length>0&&ep({emails:i,role:a,resendEmails:ee})})));case 6:(n=e.sent.flat().length)>0&&F.m.success(G.formatMessage(K.inviteSuccessToast,{numRows:n,userStr:1===n?"user":"users",workspaceName:(0,z.CV)(G,Z)})),null==T||T(),ex();case 11:return e.prev=11,ei(!1),e.finish(11);case 14:case"end":return e.stop()}},e,null,[[1,,11,14]])})),function(){return S.apply(this,arguments)}),ew=(0,P.jsx)(w.z,{color:"primary",size:E?"large":"medium",disabled:ea||0===ec.length,onClick:ej,children:ea?G.formatMessage(K.inviteMemberInviteSubmitButtonLoading):G.formatMessage(K.inviteMemberInviteSubmitButton)}),eM=(0,P.jsx)(w.z,{color:"primary",size:E?"large":"medium",disabled:0===em.length,onClick:function(){var e=new Set;ed(em.reduce(function(t,n){return e.has(n.value)||t.push(n.value),e.add(n.value),t},[]).map(function(e){return{email:e,role:eg.member}})),el(i.CSV_TABLE)},children:G.formatMessage(K.inviteMemberInviteNextButton)});return(0,P.jsxs)("div",{className:"flex flex-col gap-2",children:[es===i.INITIAL&&(0,P.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,P.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,P.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,P.jsx)("label",{htmlFor:"upload-csv",id:"upload-csv-label",children:(0,P.jsx)(j.Z,W({},K.importCSVLabel))}),(0,P.jsxs)("span",{className:"text-sm text-gray-500",children:[(0,P.jsx)(j.Z,W(W({},L?K.helperCSVFormatHide:K.helperCSVFormatShow),{},{values:{link:function(e){return(0,P.jsx)("button",{className:"underline",onClick:function(){H(!L)},children:e})}}})),L&&(0,P.jsx)("pre",{className:"mt-4",children:"email,role\nuser1@company.com,member\nadmin@company.com,admin\nit@company.com,owner"})]})]}),(0,P.jsx)("input",{ref:Q,type:"file",accept:".csv,text/csv",id:"upload-csv",className:"hidden",onChange:ev}),(0,P.jsx)("button",{className:"rounded bg-gray-100 px-4 py-2 dark:bg-gray-800",type:"button",onClick:function(){return Q.current.click()},children:(0,P.jsx)(j.Z,W({},K.importCSVButton))})]}),(0,P.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,P.jsx)("label",{htmlFor:"add-member-emails",id:"add-emails-label",children:(0,P.jsx)(j.Z,W({},K.addEmailsFieldName))}),(0,P.jsx)(R,{value:em,onChange:ef})]})]}),es===i.CSV_TABLE&&(0,P.jsxs)(P.Fragment,{children:[$&&(0,P.jsxs)("div",{className:"flex w-full items-center bg-yellow-100 p-4",children:[(0,P.jsx)(b.BJv,{className:"icon-sm mr-2 text-yellow-700"}),(0,P.jsx)("div",{className:"flex-grow text-yellow-700",children:(0,P.jsx)(j.Z,W({},K.unspecifiedRoleDescription))})]}),(0,P.jsxs)(I.Z.Root,{size:"normal",children:[(0,P.jsxs)(I.Z.Header,{children:[(0,P.jsx)(I.Z.HeaderCell,{children:(0,P.jsx)(j.Z,W({},K.inviteTableHeaderEmail))}),(0,P.jsx)(I.Z.HeaderCell,{className:"pl-3 dark:bg-gray-900",children:(0,P.jsx)(j.Z,W({},K.inviteTableHeaderRole))}),(0,P.jsx)(I.Z.HeaderCell,{})]}),(0,P.jsx)(I.Z.Body,{children:ec.map(function(e,t){return(0,P.jsxs)(I.Z.Row,{children:[(0,P.jsx)(I.Z.Cell,{children:(0,P.jsx)(_.Z,{name:"email",type:"email",value:e.email,onChange:function(e){return eh(t,"email",e.target.value)},color:"neutral"})}),(0,P.jsx)(I.Z.Cell,{children:(0,P.jsxs)(y.Z.Root,{value:e.role,onValueChange:function(e){return eh(t,"role",e)},children:[(0,P.jsxs)(y.Z.Trigger,{children:[(0,P.jsx)(y.Z.Value,{}),(0,P.jsx)(y.Z.Icon,{})]}),(0,P.jsx)(y.Z.Portal,{children:(0,P.jsxs)(y.Z.Content,{className:"border border-token-surface-secondary",children:[(0,P.jsx)(y.Z.Item,{value:eg.member,children:(0,P.jsx)(j.Z,W({},K.inviteRoleMember))}),eg.admin&&(0,P.jsx)(y.Z.Item,{value:eg.admin,children:(0,P.jsx)(j.Z,W({},K.inviteRoleAdmin))}),eg.owner&&(0,P.jsx)(y.Z.Item,{value:eg.owner,children:(0,P.jsx)(j.Z,W({},K.inviteRoleOwner))})]})})]})}),(0,P.jsx)(I.Z.Cell,{textAlign:"right",children:(0,P.jsx)(b.Ybf,{onClick:function(){return eb(t)},className:"icon-sm mr-2 cursor-pointer text-token-text-secondary"})})]},t)})})]})]}),N&&et&&(0,P.jsx)("div",{className:"mt-2 flex items-center text-left text-token-text-secondary",children:(0,P.jsx)(M.Z,{id:"resend-emails",checked:ee,onChange:function(e){return et(e.currentTarget.checked)},label:G.formatMessage(K.resendEmailsFieldName)})}),es===i.INITIAL&&Y&&(0,P.jsx)("div",{className:"mb-4",children:(0,P.jsx)(D.Z,{children:(0,P.jsx)(j.Z,W({},K.teamInviteModalNote))})}),(0,P.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,P.jsx)(w.z,{color:"neutral",size:E?"large":"medium",onClick:function(){es!==i.INITIAL?el(i.INITIAL):(ex(),k())},children:es===i.INITIAL?C:G.formatMessage(K.inviteMemberInviteBackButton)}),es===i.INITIAL?eM:ew]})]})}(a=i||(i={}))[a.INITIAL=0]="INITIAL",a[a.CSV_TABLE=1]="CSV_TABLE";var q=function(e){var t={member:"member"};return e&&(t.admin="admin",t.owner="owner"),t},K={importCSVLabel:{id:"adminPage.importCSVLabel",defaultMessage:"Import from CSV",description:"Name of label for import from CSV button"},helperCSVFormatHide:{id:"adminPage.helperCSVFormat",defaultMessage:'The file must include email and an optional role on each line. Roles can be "member", "admin", or "owner". <link>Hide Example</link>',description:"Instructions for formatting the import CSV, with a link to hide the example"},helperCSVFormatShow:{id:"adminPage.helperCSVFormat",defaultMessage:'The file must include email and an optional role on each line. Roles can be "member", "admin", or "owner". <link>Show Example</link>',description:"Instructions for formatting the import CSV, with a link to show an example"},importCSVButton:{id:"adminPage.importCSVButton",defaultMessage:"Upload",description:"Name of upload from CSV button"},addEmailsFieldName:{id:"adminPage.addEmailsFieldName.0",defaultMessage:"Emails",description:"Name of input for adding emails to workspace"},unspecifiedRoleDescription:{id:"adminPage.unspecifiedRoleDescription",defaultMessage:"Roles that were unspecified have been changed to Member.",description:"Description text for defaulting invite roles to member"},inviteTableHeaderEmail:{id:"adminPage.inviteTableHeaderEmail",defaultMessage:"Email",description:"Label for email column of invite table header"},inviteTableHeaderRole:{id:"adminPage.inviteTableHeaderRole",defaultMessage:"Role",description:"Label for role column of invite table header"},inviteRoleMember:{id:"adminPage.inviteRoleMember",defaultMessage:"Member",description:"Member role for workspace invite"},inviteRoleAdmin:{id:"adminPage.inviteRoleAdmin",defaultMessage:"Admin",description:"Admin role for workspace invite"},inviteRoleOwner:{id:"adminPage.inviteRoleOwner",defaultMessage:"Owner",description:"Owner role for workspace invite"},fileTooLargeWarning:{id:"adminPage",defaultMessage:"File is too large. Please upload a CSV file smaller than {maxSize}.",description:"Error when uploading a file that is too large"},fileIncorrectTypeWarning:{id:"adminPage",defaultMessage:"Please upload a CSV file.",description:"Error when uploading a file that is not a CSV"},resendEmailsFieldName:{id:"adminPage.resendEmailsFieldName",defaultMessage:"Resend emails for existing invites",description:"Name of checkbox input for resending emails to workspace"},teamInviteModalNote:{id:"adminPage.teamInviteModalNote",defaultMessage:"Users that accept invites will be included as additional seats on your next invoice.",description:"Note for team plan invites that additional seats will be charged"},inviteMessageLoading:{id:"adminPage.inviteMessageLoading",defaultMessage:"Sending out {numRows} invites, this may take a minute...",description:"Loading message when invites are being sent"},inviteSuccessToast:{id:"adminPage.inviteSuccessToast",defaultMessage:"Invited {numRows} {userStr} to {workspaceName}",description:"Message on successfully sending out invites"},inviteMemberInviteNextButton:{id:"adminPage.inviteMemberInviteNextButton",defaultMessage:"Next",description:"The title of the invite member modal next button"},inviteMemberInviteSubmitButton:{id:"adminPage.inviteMemberInviteSubmitButton",defaultMessage:"Send invites",description:"The title of the invite member modal submit button"},inviteMemberInviteSubmitButtonLoading:{id:"adminPage.inviteMemberInviteSubmitButtonLoading",defaultMessage:"Sending invites...",description:"Button label while inviting members"},inviteMemberInviteBackButton:{id:"adminPage.inviteMemberInviteBackButton",defaultMessage:"Back",description:"The title of the invite member modal back button"},inviteMessageFailure:{id:"adminPage.inviteMessageFailure",defaultMessage:"Unable to invite {emailsStr}",description:"Message that shows which emails were unsuccessful at being invited"}}}}]);