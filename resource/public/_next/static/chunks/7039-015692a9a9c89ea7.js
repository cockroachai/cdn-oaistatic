"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7039],{37039:function(e,a,n){n.d(a,{Z:function(){return H}});var t,i,r=n(21722),s=n(96237),l=n(39324),o=n(71209),d=n(10064),u=n(64502),c=n(38104),m=n(35250),f=n(5053),p=n(86646),g=n(17944),v=n(82473),h=n(25494),b=n(18939),x=n.n(b),M=n(70079),N=n(1454),w=n(70671),k=n(32004),I=n(48133),j=n(13205),_=n(62470),C=n(40558),S=n(19841),T=n(94968),R=n(10746),y=n(37394),Z=n(15635),P=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;function A(e){return e.split(/[\s,]+/)}function E(e){var a=e.value,n=e.onChange,t=e.className,i=(0,w.Z)(),r=(0,d._)((0,M.useState)(""),2),s=r[0],l=r[1],o=(0,M.useCallback)(function(e){if(s)switch(e.key){case"Enter":case",":case" ":var t=A(s);n((0,u._)(a).concat((0,u._)(t.map(V)))),l(""),e.preventDefault()}},[s,n,a]);return(0,m.jsx)(R.ZP,{className:(0,S.default)("react-select-container",t),isMulti:!0,onBlur:function(e){if(s){var t=A(s);n((0,u._)(a).concat((0,u._)(t.map(V)))),l(s),e.preventDefault()}},classNamePrefix:"react-select",components:B,inputValue:s,isClearable:!0,menuIsOpen:!1,onChange:n,onInputChange:l,onKeyDown:o,placeholder:i.formatMessage(L.placeholder),value:a,"aria-labelledby":"add-emails-label",name:"add-member-emails"})}var V=function(e){return{label:e,value:e,isValid:P.test(e)}},B={DropdownIndicator:function(){return null},IndicatorsContainer:function(){return null},ClearIndicator:function(){return null},MultiValueRemove:function(){return null},MultiValue:function(e){var a=(0,w.Z)(),n=(0,m.jsxs)("span",{className:"flex items-center gap-1",children:[(0,m.jsx)("span",{children:e.children}),(0,m.jsx)(N.q5L,{className:"icon-sm"})]}),t=e.data.isValid?n:(0,m.jsx)(Z.u,{label:a.formatMessage(L.tooltipInvalidEmail,{email:e.data.value}),side:"top",children:n});return(0,m.jsx)(y.c.MultiValue,(0,o._)((0,l._)({},e),{children:(0,m.jsx)("button",{className:(0,S.default)("m-1 cursor-pointer rounded-full border border-transparent py-1 pl-3 pr-2 text-sm dark:text-gray-300",e.data.isValid?"bg-gray-50 hover:border-gray-300 hover:bg-gray-100 dark:bg-gray-800 dark:hover:border-gray-600 dark:hover:bg-gray-700":"bg-red-200 text-red-500 dark:text-red-500"),onClick:function(a){var n,t;null===(t=(n=e.removeProps).onClick)||void 0===t||t.call(n,a),a.preventDefault()},"aria-label":a.formatMessage(L.removeMember,{member:e.data.value}),children:t})}))}},L=(0,T.vU)({membersAdded:{id:"emailsTextarea.membersAdded",defaultMessage:"+{count} {count, plural, one {member} other {members}}",description:"Current number of members that will be added to the workspace"},removeMember:{id:"emailsTextarea.removeMember",defaultMessage:"Remove {member}",description:"Remove a member from the list of members to be added"},tooltipInvalidEmail:{id:"emailsTextarea.tooltipInvalidEmail",defaultMessage:'"{email}" may not be a valid email',description:"Tooltip for invalid email addresses"},clearAllEntries:{id:"emailsTextarea.clearAllEntries",defaultMessage:"Clear all",description:"Clear all entries in the list of members to be added"},placeholder:{id:"emailsTextarea.placeholder",defaultMessage:"Type an email and press enter...",description:"Placeholder for the insert emails textarea"}}),W=n(89319),F=n(7171),z=n(72290),D=n(12296);function H(e){var a,n,t,b,S,T,R=e.workspace,y=e.canResendInviteEmails,Z=e.onCancel,A=e.cancelButtonText,V=e.onSuccess,B=e.fullWidthButtons,L=void 0!==B&&B,H=(0,D.Gk)(R.id),J=(0,d._)((0,M.useState)(!1),2),q=J[0],G=J[1],$=(0,d._)((0,M.useState)(!1),2),K=$[0],Q=$[1],Y=(0,M.useRef)(null),X=(0,g.ec)(g.F_.isTeamPlan),ee=(0,w.Z)(),ea=(0,d._)((0,M.useState)(!0),2),en=ea[0],et=ea[1],ei=(0,d._)((0,M.useState)(!1),2),er=ei[0],es=ei[1],el=(0,d._)((0,M.useState)(i.INITIAL),2),eo=el[0],ed=el[1],eu=(0,d._)((0,M.useState)([]),2),ec=eu[0],em=eu[1],ef=(0,d._)((0,M.useState)([]),2),ep=ef[0],eg=ef[1],ev=(a=R.id,t=(0,w.Z)(),b=(0,v.NL)(),(0,h.D)({mutationFn:(n=(0,r._)(function(e){var n,i,s,l,o,d;return(0,c.Jh)(this,function(u){switch(u.label){case 0:var m;for(n=e.emails,i=e.role,s=e.resendEmails,l=[],o=Math.max(5,Math.round(n.length/10)),d=0;d<n.length;d+=o)l.push(n.slice(d,d+o));return m=(0,r._)(function(e){return(0,c.Jh)(this,function(n){return[2,p.ZP.addWorkspaceUsers(a,e,i,s).then(function(e){return e.errored_emails.length>0&&z.m.danger(t.formatMessage(U.inviteMessageFailure,{emailsStr:e.errored_emails.map(function(e){var a=e.email_address,n=e.error;return"".concat(a,": ").concat(n)}).join(", ")})),e.account_invites}).catch(function(e){throw z.m.danger(e.message),e})]})}),[4,Promise.all(l.map(function(e){return function(e){return m.apply(this,arguments)}(e)}))];case 1:return[2,u.sent().flat()]}})}),function(e){return n.apply(this,arguments)}),onSuccess:function(){b.invalidateQueries({queryKey:["workspace","invites",a]}),null==V||V()}})).mutateAsync,eh=O(H),eb=(S=(0,r._)(function(e){var a,n,t;return(0,c.Jh)(this,function(r){switch(r.label){case 0:if(!(n=null===(a=e.target.files)||void 0===a?void 0:a[0]))return[3,2];return[4,new Promise(function(e){if(n.size/1048576>25)e({status:"error",reason:"file_too_large"});else if("text/csv"!==n.type)e({status:"error",reason:"invalid_file_type"});else{var a=new FileReader;a.readAsText(n),a.onload=function(a){var n,t=K,i=(null===(n=a.target)||void 0===n?void 0:n.result).split("\n"),r=new Set;e({status:"success",newRows:i.reduce(function(e,a){var n,i=(0,d._)(a.split(",").map(function(e){return e.trim()}),2),s=i[0],l=i[1];return P.test(s)&&!r.has(s)&&(void 0!==eh[l]||t||(t=!0),e.push({email:s,role:null!==(n=eh[l])&&void 0!==n?n:eh.member})),r.add(s),e},[]),hasWarning:t})}}})];case 1:"success"===(t=r.sent()).status?(em(t.newRows),ed(i.CSV_TABLE),Q(t.hasWarning)):"file_too_large"===t.reason?z.m.danger(ee.formatMessage(U.fileTooLargeWarning,{maxSize:"".concat(25,"MB")}),{duration:5}):"invalid_file_type"===t.reason&&z.m.danger(ee.formatMessage(U.fileIncorrectTypeWarning),{duration:5}),r.label=2;case 2:return[2]}})}),function(e){return S.apply(this,arguments)}),ex=function(e,a,n){var t=(0,u._)(ec);t[e]=(0,o._)((0,l._)({},t[e]),(0,s._)({},a,n)),em(t)},eM=function(e){em((0,u._)(ec.slice(0,e)).concat((0,u._)(ec.slice(e+1))))},eN=(0,M.useCallback)(function(){em([]),ed(i.INITIAL),es(!1),eg([])},[]),ew=(T=(0,r._)(function(){var e,a;return(0,c.Jh)(this,function(n){switch(n.label){case 0:es(!0),n.label=1;case 1:return n.trys.push([1,,3,4]),ec.length>5&&z.m.info(ee.formatMessage(U.inviteMessageLoading,{numRows:ec.length}),{hasCloseButton:!0}),e=[["admin",f.r3.ADMIN],["owner",f.r3.OWNER],["member",f.r3.STANDARD]],[4,Promise.all(x()(e.map(function(e){var a=(0,d._)(e,2),n=a[0],t=a[1],i=ec.filter(function(e){return e.role===n}).map(function(e){return e.email});return i.length>0&&ev({emails:i,role:t,resendEmails:en})})))];case 2:return(a=n.sent().flat().length)>0&&z.m.success(ee.formatMessage(U.inviteSuccessToast,{numRows:a,userStr:1===a?"user":"users",workspaceName:R.name})),null==V||V(),eN(),[3,4];case 3:return es(!1),[7];case 4:return[2]}})}),function(){return T.apply(this,arguments)}),ek=(0,m.jsx)(I.z,{color:"primary",size:L?"large":"medium",disabled:er||0===ec.length,onClick:ew,children:er?ee.formatMessage(U.inviteMemberInviteSubmitButtonLoading):ee.formatMessage(U.inviteMemberInviteSubmitButton)}),eI=(0,m.jsx)(I.z,{color:"primary",size:L?"large":"medium",disabled:0===ep.length,onClick:function(){var e=new Set;em(ep.reduce(function(a,n){return e.has(n.value)||a.push(n.value),e.add(n.value),a},[]).map(function(e){return{email:e,role:eh.member}})),ed(i.CSV_TABLE)},children:ee.formatMessage(U.inviteMemberInviteNextButton)});return(0,m.jsxs)("div",{className:"flex flex-col gap-2",children:[eo===i.INITIAL&&(0,m.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,m.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,m.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,m.jsx)("label",{htmlFor:"upload-csv",id:"upload-csv-label",children:(0,m.jsx)(k.Z,(0,l._)({},U.importCSVLabel))}),(0,m.jsxs)("span",{className:"text-sm text-gray-500",children:[(0,m.jsx)(k.Z,(0,o._)((0,l._)({},q?U.helperCSVFormatHide:U.helperCSVFormatShow),{values:{link:function(e){return(0,m.jsx)("button",{className:"underline",onClick:function(){G(!q)},children:e})}}})),q&&(0,m.jsx)("pre",{className:"mt-4",children:"email,role\nuser1@company.com,member\nadmin@company.com,admin\nit@company.com,owner"})]})]}),(0,m.jsx)("input",{ref:Y,type:"file",accept:".csv,text/csv",id:"upload-csv",className:"hidden",onChange:eb}),(0,m.jsx)("button",{className:"rounded bg-gray-100 px-4 py-2 dark:bg-gray-800",type:"button",onClick:function(){return Y.current.click()},children:(0,m.jsx)(k.Z,(0,l._)({},U.importCSVButton))})]}),(0,m.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,m.jsx)("label",{htmlFor:"add-member-emails",id:"add-emails-label",children:(0,m.jsx)(k.Z,(0,l._)({},U.addEmailsFieldName))}),(0,m.jsx)(E,{value:ep,onChange:eg})]})]}),eo===i.CSV_TABLE&&(0,m.jsxs)(m.Fragment,{children:[K&&(0,m.jsxs)("div",{className:"flex w-full items-center bg-yellow-100 p-4",children:[(0,m.jsx)(N.BJv,{className:"icon-sm mr-2 text-yellow-700"}),(0,m.jsx)("div",{className:"flex-grow text-yellow-700",children:(0,m.jsx)(k.Z,(0,l._)({},U.unspecifiedRoleDescription))})]}),(0,m.jsxs)(C.Z.Root,{size:"normal",children:[(0,m.jsxs)(C.Z.Header,{children:[(0,m.jsx)(C.Z.HeaderCell,{children:(0,m.jsx)(k.Z,(0,l._)({},U.inviteTableHeaderEmail))}),(0,m.jsx)(C.Z.HeaderCell,{className:"pl-3 dark:bg-gray-900",children:(0,m.jsx)(k.Z,(0,l._)({},U.inviteTableHeaderRole))}),(0,m.jsx)(C.Z.HeaderCell,{})]}),(0,m.jsx)(C.Z.Body,{children:ec.map(function(e,a){return(0,m.jsxs)(C.Z.Row,{children:[(0,m.jsx)(C.Z.Cell,{children:(0,m.jsx)(W.Z,{name:"email",type:"email",value:e.email,onChange:function(e){return ex(a,"email",e.target.value)},color:"neutral"})}),(0,m.jsx)(C.Z.Cell,{children:(0,m.jsxs)(_.Z.Root,{value:e.role,onValueChange:function(e){return ex(a,"role",e)},children:[(0,m.jsxs)(_.Z.Trigger,{children:[(0,m.jsx)(_.Z.Value,{}),(0,m.jsx)(_.Z.Icon,{})]}),(0,m.jsx)(_.Z.Portal,{children:(0,m.jsxs)(_.Z.Content,{className:"border border-token-surface-secondary",children:[(0,m.jsx)(_.Z.Item,{value:eh.member,children:(0,m.jsx)(k.Z,(0,l._)({},U.inviteRoleMember))}),eh.admin&&(0,m.jsx)(_.Z.Item,{value:eh.admin,children:(0,m.jsx)(k.Z,(0,l._)({},U.inviteRoleAdmin))}),eh.owner&&(0,m.jsx)(_.Z.Item,{value:eh.owner,children:(0,m.jsx)(k.Z,(0,l._)({},U.inviteRoleOwner))})]})})]})}),(0,m.jsx)(C.Z.Cell,{textAlign:"right",children:(0,m.jsx)(N.Ybf,{onClick:function(){return eM(a)},className:"icon-sm mr-2 cursor-pointer text-token-text-secondary"})})]},a)})})]})]}),y&&et&&(0,m.jsx)("div",{className:"mt-2 flex items-center text-left text-token-text-secondary",children:(0,m.jsx)(j.Z,{id:"resend-emails",checked:en,onChange:function(e){return et(e.currentTarget.checked)},label:ee.formatMessage(U.resendEmailsFieldName)})}),eo===i.INITIAL&&X&&(0,m.jsx)("div",{className:"mb-4",children:(0,m.jsx)(F.Z,{children:(0,m.jsx)(k.Z,(0,l._)({},U.teamInviteModalNote))})}),(0,m.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,m.jsx)(I.z,{color:"neutral",size:L?"large":"medium",onClick:function(){eo!==i.INITIAL?ed(i.INITIAL):(eN(),Z())},children:eo===i.INITIAL?A:ee.formatMessage(U.inviteMemberInviteBackButton)}),eo===i.INITIAL?eI:ek]})]})}(t=i||(i={}))[t.INITIAL=0]="INITIAL",t[t.CSV_TABLE=1]="CSV_TABLE";var O=function(e){var a={member:"member"};return e&&(a.admin="admin",a.owner="owner"),a},U={importCSVLabel:{id:"adminPage.importCSVLabel",defaultMessage:"Import from CSV",description:"Name of label for import from CSV button"},helperCSVFormatHide:{id:"adminPage.helperCSVFormat",defaultMessage:'The file must include email and an optional role on each line. Roles can be "member", "admin", or "owner". <link>Hide Example</link>',description:"Instructions for formatting the import CSV, with a link to hide the example"},helperCSVFormatShow:{id:"adminPage.helperCSVFormat",defaultMessage:'The file must include email and an optional role on each line. Roles can be "member", "admin", or "owner". <link>Show Example</link>',description:"Instructions for formatting the import CSV, with a link to show an example"},importCSVButton:{id:"adminPage.importCSVButton",defaultMessage:"Upload",description:"Name of upload from CSV button"},addEmailsFieldName:{id:"adminPage.addEmailsFieldName.0",defaultMessage:"Emails",description:"Name of input for adding emails to workspace"},unspecifiedRoleDescription:{id:"adminPage.unspecifiedRoleDescription",defaultMessage:"Roles that were unspecified have been changed to Member.",description:"Description text for defaulting invite roles to member"},inviteTableHeaderEmail:{id:"adminPage.inviteTableHeaderEmail",defaultMessage:"Email",description:"Label for email column of invite table header"},inviteTableHeaderRole:{id:"adminPage.inviteTableHeaderRole",defaultMessage:"Role",description:"Label for role column of invite table header"},inviteRoleMember:{id:"adminPage.inviteRoleMember",defaultMessage:"Member",description:"Member role for workspace invite"},inviteRoleAdmin:{id:"adminPage.inviteRoleAdmin",defaultMessage:"Admin",description:"Admin role for workspace invite"},inviteRoleOwner:{id:"adminPage.inviteRoleOwner",defaultMessage:"Owner",description:"Owner role for workspace invite"},fileTooLargeWarning:{id:"adminPage",defaultMessage:"File is too large. Please upload a CSV file smaller than {maxSize}.",description:"Error when uploading a file that is too large"},fileIncorrectTypeWarning:{id:"adminPage",defaultMessage:"Please upload a CSV file.",description:"Error when uploading a file that is not a CSV"},resendEmailsFieldName:{id:"adminPage.resendEmailsFieldName",defaultMessage:"Resend emails for existing invites",description:"Name of checkbox input for resending emails to workspace"},teamInviteModalNote:{id:"adminPage.teamInviteModalNote",defaultMessage:"Users that accept invites will be included as additional seats on your next invoice.",description:"Note for team plan invites that additional seats will be charged"},inviteMessageLoading:{id:"adminPage.inviteMessageLoading",defaultMessage:"Sending out {numRows} invites, this may take a minute...",description:"Loading message when invites are being sent"},inviteSuccessToast:{id:"adminPage.inviteSuccessToast",defaultMessage:"Invited {numRows} {userStr} to {workspaceName}",description:"Message on successfully sending out invites"},inviteMemberInviteNextButton:{id:"adminPage.inviteMemberInviteNextButton",defaultMessage:"Next",description:"The title of the invite member modal next button"},inviteMemberInviteSubmitButton:{id:"adminPage.inviteMemberInviteSubmitButton",defaultMessage:"Send invites",description:"The title of the invite member modal submit button"},inviteMemberInviteSubmitButtonLoading:{id:"adminPage.inviteMemberInviteSubmitButtonLoading",defaultMessage:"Sending invites...",description:"Button label while inviting members"},inviteMemberInviteBackButton:{id:"adminPage.inviteMemberInviteBackButton",defaultMessage:"Back",description:"The title of the invite member modal back button"},inviteMessageFailure:{id:"adminPage.inviteMessageFailure",defaultMessage:"Unable to invite {emailsStr}",description:"Message that shows which emails were unsuccessful at being invited"}}},12296:function(e,a,n){n.d(a,{$3:function(){return c},Ap:function(){return o},CV:function(){return m},GA:function(){return u},Gk:function(){return v},bE:function(){return h},cI:function(){return f},my:function(){return g},qH:function(){return d}});var t=n(96237),i=n(5053),r=n(17944),s=n(70079),l=n(70671);function o(){var e=(0,l.Z)(),a=e.formatMessage(b.adminRoleName),n=e.formatMessage(b.ownerRoleName),r=e.formatMessage(b.standardRoleName);return(0,s.useMemo)(function(){var e;return e={},(0,t._)(e,i.r3.OWNER,n),(0,t._)(e,i.r3.ADMIN,a),(0,t._)(e,i.r3.STANDARD,r),e},[n,a,r])}function d(e){var a=(0,l.Z)(),n=(0,r.ec)(r.F_.isTeamPlan),t=(0,r.ec)(r.F_.isEnterprisePlan);if(e){if(n)return a.formatMessage(b.teamPlanName);if(t)return a.formatMessage(b.enterprisePlanName)}return a.formatMessage(b.personalPlanName)}function u(e){return m((0,l.Z)(),e)}function c(){var e=(0,r.ec)(function(e){return e.currentWorkspace});return m((0,l.Z)(),e)}function m(e,a){var n;return a&&a.structure!==i.CZ.PERSONAL?null!==(n=a.name)&&void 0!==n?n:e.formatMessage(b.defaultWorkspaceTitle):e.formatMessage(b.personalWorkspaceTitle)}function f(){var e,a,n=(0,r.aF)();return null!==(a=null!==(e=null==n?void 0:n.name)&&void 0!==e?e:null==n?void 0:n.email)&&void 0!==a?a:null}function p(){return(0,r.ec)(function(e){return e.workspaces})}function g(){return(0,r.ec)(function(e){return e.workspaces.filter(function(e){return!e.deactivated})})}function v(e){var a=p().find(function(a){return a.id===e});return(null==a?void 0:a.role)===i.r3.OWNER}function h(e){var a=p().find(function(a){return a.id===e});return(null==a?void 0:a.role)===i.r3.ADMIN}var b=(0,n(94968).vU)({defaultWorkspaceTitle:{id:"useWorkspaces.defaultWorkspaceTitle",defaultMessage:"Untitled Workspace",description:"title for workspace without a name"},personalWorkspaceTitle:{id:"useWorkspaces.personalWorkspaceTitle",defaultMessage:"Personal account",description:"title for personal workspace"},personalPlanName:{id:"useWorkspaces.personalPlanName",defaultMessage:"Personal",description:"label for personal tier account"},enterprisePlanName:{id:"useWorkspaces.enterprisePlanName",defaultMessage:"Enterprise",description:"label for enterprise tier account"},teamPlanName:{id:"useWorkspaces.teamPlanName",defaultMessage:"Team",description:"label for team tier account"},adminRoleName:{id:"useWorkspaces.adminRoleName",defaultMessage:"Admin",description:"Role name for an admin user"},ownerRoleName:{id:"useWorkspaces.ownerRoleName",defaultMessage:"Owner",description:"Role name for an owner user"},standardRoleName:{id:"useWorkspacews.standardRoleName",defaultMessage:"Member",description:"Role name for a standard user"}})}}]);