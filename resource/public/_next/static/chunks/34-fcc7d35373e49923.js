"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[34],{34:function(e,n,t){t.r(n),t.d(n,{__N_SSP:function(){return nY},default:function(){return n$}});var i,r,o,a,s,l,c,u=t(35250),d=t(21950),m=t(21722),p=t(39324),f=t(71209),h=t(10064),g=t(64502),v=t(38104),x=t(5053),y=t(73780),b=t(94705),j=t(7184),_=t(30769);function w(e){var n,t=e.gizmoId,i=(0,d.b9)(t,!0).data,r=(n=(0,m._)(function(){return(0,v.Jh)(this,function(e){switch(e.label){case 0:return[4,_.U.postGizmoCancelAppeal(t)];case 1:return e.sent(),[2]}})}),function(){return n.apply(this,arguments)});return(0,u.jsx)(j.Z,{isOpen:!0,onClose:function(){},primaryButton:(0,u.jsx)(b.ZP.Button,{title:"Cancel appeal",color:"primary",onClick:r}),type:"warning",children:(0,u.jsxs)("div",{className:"flex flex-col gap-2 text-sm",children:[(0,u.jsx)("h2",{className:"text-lg font-semibold",children:"Reviewing your appeal"}),(0,u.jsxs)("p",{children:["During the review you can continue using “",null==i?void 0:i.gizmo.display.name,"” as your private GPT, but won’t be able to update it or share it with others."]})]})})}var N=t(4337),T=t(21389);function P(){var e=(0,N._)(["bold underline"]);return P=function(){return e},e}var k=T.Z.a(P());function z(e){var n=e.isFlaggedBrandName,t=e.onClose;return(0,u.jsx)(j.Z,{title:"Your changes couldn’t be published",isOpen:!0,onClose:t,closeButton:(0,u.jsx)(b.ZP.CloseButton,{onClose:t}),primaryButton:(0,u.jsx)(b.ZP.Button,{title:"Continue",color:"primary",onClick:t}),type:"warning",children:(0,u.jsx)("div",{className:"flex flex-col gap-2 text-sm",children:n?(0,u.jsxs)("p",{children:["Your GPT’s name is restricted for public sharing. If this is your organization’s name, please verify your website via the"," ",(0,u.jsx)(k,{href:"/#settings/BuilderProfile",children:"Builder profile in Settings"}),"."]}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("p",{children:"Your GPT isn’t ready for public sharing yet. Usually, it’s a quick fix."}),(0,u.jsx)("p",{children:"Here’s what you can do"}),(0,u.jsxs)("ul",{className:"list-disc pl-5",children:[(0,u.jsxs)("li",{children:[(0,u.jsx)("b",{children:"Review your info:"})," Check that your description, name, and profile picture meet our"," ",(0,u.jsx)(k,{target:"_blank",href:"https://openai.com/brand",rel:"noreferrer",children:"brand"})," ","and"," ",(0,u.jsx)(k,{target:"_blank",href:"https://openai.com/policies/usage-policies",rel:"noreferrer",children:"usage"})," ","guidelines."]}),(0,u.jsxs)("li",{children:[(0,u.jsx)("b",{children:"Share again:"})," Once updated, go ahead and share your GPT."]})]}),(0,u.jsxs)("p",{children:["Concerns? Your feedback is welcome"," ",(0,u.jsx)(k,{target:"_blank",href:"https://forms.gle/qXd1PjZmuJYhvxow5",rel:"noreferrer",children:"here"})," ","and helps us improve."]}),(0,u.jsx)("p",{children:"Feel free to use your GPT privately for now by publishing to “only me”."})]})})})}var C=t(80275),I=t(42798),M=t(72290),G=t(62682),S=t(66638),E=t(17944),A=t(93028),L=t(8679),U=t(18481),D=t(70079),Z=t(35427),R=t(68951),O=t(19841),V=t(61888),J=t(10721),q=t.n(J),B=t(70671),W=t(70216),F=t(61098),H=t(48133),K=t(35265),Q=t(89319),X={Root:function(e){var n=e.className,t=e.children,i=(0,W._)(e,["className","children"]);return(0,u.jsx)(Z.fC,(0,f._)((0,p._)({className:n},i),{children:t}))},Item:function(e){var n=e.value,t=e.className,i=e.label,r=(0,W._)(e,["value","className","label"]);return(0,u.jsxs)("div",{className:"flex items-center gap-2",children:[(0,u.jsx)(Z.ck,(0,p._)({id:n,value:n,className:(0,O.default)("h-4 w-4 flex-shrink-0 gap-2 rounded-full border border-token-text-tertiary bg-transparent shadow-sm outline-none hover:bg-token-surface-tertiary",t)},r)),(0,u.jsx)("label",{htmlFor:n,className:"w-full cursor-pointer",children:i})]})},Indicator:function(e){var n=e.className,t=(0,W._)(e,["className"]);return(0,u.jsx)(Z.z$,(0,p._)({className:(0,O.default)("relative flex h-full w-full items-center justify-center after:block after:h-2 after:w-2 after:rounded-[50%] after:bg-token-text-primary after:content-['']",n)},t))}};function Y(e){var n=e.content,t=e.button,i=e.onClick;return(0,u.jsxs)("div",{className:"flex rounded-lg border border-token-border-medium text-sm hover:cursor-pointer",onClick:i,children:[(0,u.jsx)("div",{className:"h-9 grow px-3 py-2",children:n}),(0,u.jsx)("div",{className:"w-px border border-token-border-medium"}),t]})}var $=t(94968);function ee(e){var n=e.onSelectExample,t=(0,B.Z)(),i=(0,D.useRef)(null);return(0,u.jsxs)("select",{onChange:function(e){"label"!==e.target.value&&(n(et[parseInt(e.target.value)].spec),i.current.value="label")},className:"h-8 rounded-lg border border-token-border-medium bg-transparent px-2 py-0 text-sm",ref:i,children:[(0,u.jsx)("option",{value:"label",children:t.formatMessage(en.examples)}),et.map(function(e,n){return(0,u.jsx)("option",{value:n,children:t.formatMessage(e.displayName)},n)})]})}var en=(0,$.vU)({examples:{id:"gizmo.actions.examples",defaultMessage:"Examples",description:"Label of examples in GPT actions editor"},weatherExampleTitle:{id:"gizmo.actions.weatherExampleTitle",defaultMessage:"Weather (JSON)",description:"Dropdown label for the weather OpenAPI example"},petStoreExampleTitle:{id:"gizmo.actions.petStoreExampleTitle",defaultMessage:"Pet Store (YAML)",description:"Dropdown label for the pet store OpenAPI example"},blankExampleTitle:{id:"gizmo.actions.blankExampleTitle",defaultMessage:"Blank Template",description:"Dropdown label for the blank template OpenAPI spec"}}),et=[{displayName:en.weatherExampleTitle,spec:JSON.stringify({openapi:"3.1.0",info:{title:"Get weather data",description:"Retrieves current weather data for a location.",version:"v1.0.0"},servers:[{url:"https://weather.example.com"}],paths:{"/location":{get:{description:"Get temperature for a specific location",operationId:"GetCurrentWeather",parameters:[{name:"location",in:"query",description:"The city and state to retrieve the weather for",required:!0,schema:{type:"string"}}],deprecated:!1}}},components:{schemas:{}}},null,2)},{displayName:en.petStoreExampleTitle,spec:'# Taken from https://github.com/OAI/OpenAPI-Specification/blob/main/examples/v3.0/petstore.yaml\n\nopenapi: "3.0.0"\ninfo:\n  version: 1.0.0\n  title: Swagger Petstore\n  license:\n    name: MIT\nservers:\n  - url: https://petstore.swagger.io/v1\npaths:\n  /pets:\n    get:\n      summary: List all pets\n      operationId: listPets\n      tags:\n        - pets\n      parameters:\n        - name: limit\n          in: query\n          description: How many items to return at one time (max 100)\n          required: false\n          schema:\n            type: integer\n            maximum: 100\n            format: int32\n      responses:\n        \'200\':\n          description: A paged array of pets\n          headers:\n            x-next:\n              description: A link to the next page of responses\n              schema:\n                type: string\n          content:\n            application/json:    \n              schema:\n                $ref: "#/components/schemas/Pets"\n        default:\n          description: unexpected error\n          content:\n            application/json:\n              schema:\n                $ref: "#/components/schemas/Error"\n    post:\n      summary: Create a pet\n      operationId: createPets\n      tags:\n        - pets\n      responses:\n        \'201\':\n          description: Null response\n        default:\n          description: unexpected error\n          content:\n            application/json:\n              schema:\n                $ref: "#/components/schemas/Error"\n  /pets/{petId}:\n    get:\n      summary: Info for a specific pet\n      operationId: showPetById\n      tags:\n        - pets\n      parameters:\n        - name: petId\n          in: path\n          required: true\n          description: The id of the pet to retrieve\n          schema:\n            type: string\n      responses:\n        \'200\':\n          description: Expected response to a valid request\n          content:\n            application/json:\n              schema:\n                $ref: "#/components/schemas/Pet"\n        default:\n          description: unexpected error\n          content:\n            application/json:\n              schema:\n                $ref: "#/components/schemas/Error"\ncomponents:\n  schemas:\n    Pet:\n      type: object\n      required:\n        - id\n        - name\n      properties:\n        id:\n          type: integer\n          format: int64\n        name:\n          type: string\n        tag:\n          type: string\n    Pets:\n      type: array\n      maxItems: 100\n      items:\n        $ref: "#/components/schemas/Pet"\n    Error:\n      type: object\n      required:\n        - code\n        - message\n      properties:\n        code:\n          type: integer\n          format: int32\n        message:\n          type: string'},{displayName:en.blankExampleTitle,spec:JSON.stringify({openapi:"3.1.0",info:{title:"Untitled",description:"Your OpenAPI specification",version:"v1.0.0"},servers:[{url:""}],paths:{},components:{schemas:{}}},null,2)}],ei=t(96114),er=t(15635),eo=t(23211),ea=t(47428),es=t(76483),el=t(1454),ec=t(66161),eu=t(68260),ed=t(12065),em=t(98135),ep=t(91202),ef=t(19797),eh=t(17130),eg=t(418),ev=t(10943);function ex(){return(0,u.jsx)("div",{className:"relative flex h-full w-full items-center justify-center rounded-full border-2 border-dashed border-black border-token-border-medium",children:(0,u.jsx)(I.Z,{className:"h-1/4 w-1/4"})})}function ey(e){var n=e.gizmoEditorData,t=e.onFileChange,i=e.generateProfilePic,r=e.isGeneratingProfilePic,o=e.setIsGeneratingProfilePic,a=(0,B.Z)(),s=(0,h._)((0,D.useState)(void 0),2),l=s[0],c=s[1],d=(0,D.useRef)(t);function g(){return(g=(0,m._)(function(e){var n,t;return(0,v.Jh)(this,function(i){switch(i.label){case 0:if(!(e.length>0))return[3,2];return o(!1),[4,(0,eh.WI)(e[0],512)];case 1:n=i.sent(),c({tempId:t=(0,ef.W7)(n),file:n,status:ep.X.Uploading,progress:1,fileId:null,cdnUrl:null}),d.current("uploading"),(0,ef.lU)(t,n,a,x.Ei.ProfilePicture,{onFileCreated:function(e,n,t){c(function(i){return"initial"!==i&&(null==i?void 0:i.tempId)===e&&i.status===ep.X.Uploading?(0,f._)((0,p._)({},i),{progress:10,fileId:n,cdnUrl:t}):i})},onFileUploadProgress:function(e,n){c(function(t){return"initial"!==t&&(null==t?void 0:t.tempId)===e&&t.status===ep.X.Uploading?(0,f._)((0,p._)({},t),{progress:n}):t})},onFileUploaded:function(e,n){c(function(t){return"initial"!==t&&(null==t?void 0:t.tempId)===e?(d.current(t),(0,f._)((0,p._)({},t),{status:ep.X.Ready,progress:100,fileSpec:(0,p._)({name:t.file.name,id:t.fileId,size:t.file.size},null!=n?n:{})})):t})},onError:function(e){c(function(n){if("initial"!==n&&(null==n?void 0:n.tempId)===e){d.current(void 0);return}return n})}}),i.label=2;case 2:return[2]}})})).apply(this,arguments)}(0,D.useEffect)(function(){d.current=t});var y=(0,es.uI)((0,p._)({disabled:!1,noClick:!0,onDropAccepted:function(e){return g.apply(this,arguments)},onDropRejected:function(e){return(0,ed.UJ)(e,a,ep.A.ProfilePicture)},multiple:!0,maxSize:eu.xC},(0,eh.Z8)(eh.KL))),b=y.open,j=y.getInputProps;return(0,u.jsx)("div",{className:"flex w-full items-center justify-center gap-4",children:(0,u.jsxs)(ea.fC,{children:[(0,u.jsx)(ea.xz,{className:"h-20 w-20",children:r?(0,u.jsx)(ex,{}):null!=l&&"initial"!=l&&l.status!=ep.X.Ready?(0,u.jsxs)("div",{className:"relative h-full w-full overflow-hidden rounded-full",children:[(0,u.jsx)(em.l,{file:l.file}),l.status===ep.X.Uploading&&l.progress<90?(0,u.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/5 text-white",children:(0,u.jsx)(ec.Z,{percentage:l.progress,className:"h-6 w-6"})}):null]}):(null==n?void 0:n.profilePictureUrl)!=null&&(null==n?void 0:n.profilePictureUrl)!==""?(0,u.jsx)(eg.Z,{isFirstParty:!1,src:n.profilePictureUrl}):(0,u.jsx)("div",{className:"flex h-full w-full items-center justify-center rounded-full border-2 border-dashed border-black border-token-border-medium",children:(0,u.jsx)(el.OvN,{className:"text-4xl"})})}),(0,u.jsx)(ea.Uv,{children:(0,u.jsxs)(ea.VY,{className:"flex min-w-[100px] max-w-xs flex-col rounded-xl border border-gray-400 bg-token-surface-primary shadow-lg dark:border-gray-700",sideOffset:7,children:[(0,u.jsxs)(ev.UA,{onClick:b,children:[(0,u.jsx)("input",(0,p._)({},j())),"Upload Photo"]}),(0,u.jsx)(ev.UA,{onClick:i,children:"Use DALL\xb7E"})]})})]})})}var eb=t(10499),ej=t(86646),e_=t(70737),ew=t(97296),eN=t(7137),eT=t(32004),eP=t(54636),ek=t(42780);function ez(e){var n,t,i=e.gizmoEditorData,r=e.requireGizmoId,o=e.currentModelConfig,a=e.updateGizmo,s=function(e){return(0,u.jsx)(em.Z,{onRemoveFileClick:function(){b.current.delete(e.tempId),y(function(e){return e+1})},file:e.file,loadingPercentage:e.status===ep.X.Uploading?e.progress:void 0},e.tempId)},l=function(e){return(0,u.jsx)(em.Z,{file:e.name,fileId:e.file_id,onRemoveFileClick:function(){return a(function(n){var t;return(0,f._)((0,p._)({},n),{files:null==n?void 0:null===(t=n.files)||void 0===t?void 0:t.filter(function(n){return n.file_id!==e.file_id})})})},gizmoId:null==i?void 0:i.id},e.file_id)},c=(0,B.Z)(),d=(0,h._)((0,D.useState)(0),2),y=(d[0],d[1]),b=(0,D.useRef)(new Map),j=(0,eh.Zp)(o,void 0),_=(n=(0,m._)(function(e){var n;return(0,v.Jh)(this,function(t){switch(t.label){case 0:return eP.A.logEvent(ek.M.uploadFile,{eventSource:"mouse",intent:"gizmo"}),[4,r()];case 1:if(n=t.sent(),!(e.length>0))return[3,3];return[4,Promise.all(e.map(function(e){var t=(0,ef.W7)(e);b.current.set(t,{tempId:t,gizmoId:n,file:e,status:ep.X.Uploading,progress:1,fileId:null,cdnUrl:null}),(0,ef.cT)((0,ef.W7)(e),e,c,{kind:x.Ei.Gizmo,gizmoId:n},{onFileUploaded:function(e,n,t){var i,r=b.current.get(e);null!=r&&null!=r.fileId&&(a(function(e){return(0,f._)((0,p._)({},e),{files:(0,g._)(null!==(i=e.files)&&void 0!==i?i:[]).concat([{file_id:r.fileId,name:r.file.name,size:r.file.size,type:r.file.type,last_modified:r.file.lastModified,file_size_tokens:null==t?void 0:t.fileTokenSize}])})}),b.current.delete(e),y(function(e){return e+1}))},onFileCreated:function(t,i,r){b.current.set(t,(0,f._)((0,p._)({tempId:t,gizmoId:n,file:e,status:ep.X.Uploading,progress:1},b.current.get(t)),{fileId:i,cdnUrl:r})),y(function(e){return e+1})},onFileUploadProgress:function(e,n){var t=b.current.get(e);(null==t?void 0:t.status)===ep.X.Uploading&&b.current.set(e,(0,f._)((0,p._)({},t),{progress:n})),y(function(e){return e+1})},onError:function(e){b.current.delete(e)}},{usesRetrievalIndex:null!=o&&(0,eh._0)(o,e.type,e.name)===x.Cd.Retrieval})}))];case 2:t.sent(),t.label=3;case 3:return[2]}})}),function(e){return n.apply(this,arguments)}),w=(0,es.uI)((0,p._)({disabled:!1,noClick:!0,onDropAccepted:_,multiple:!0,maxSize:eu.xC,maxFiles:10},(0,eh.Z8)(j))),N=w.getInputProps,T=w.open,P=null!==(t=null==i?void 0:i.files)&&void 0!==t?t:[],k=Array.from(b.current.values()).filter(function(e){return P.every(function(n){return n.file_id!==e.fileId})}),z=(0,h._)((0,V.partition)(k,function(e){return null!=o&&(0,eh._0)(o,e.file.type,e.file.name)===x.Cd.CodeInterpreter}),2),C=z[0],I=z[1],M=(0,h._)((0,V.partition)(P,function(e){return null!=o&&null!=e.type&&(0,eh._0)(o,e.type,e.name)===x.Cd.CodeInterpreter}),2),G=M[0],S=M[1],E=(0,D.useRef)(G.length);return(0,D.useEffect)(function(){if(G.length>E.current){var e;a(function(n){var t;return(null===(t=n.tools)||void 0===t?void 0:t.some(function(e){return e.type===x.qK.PYTHON}))?n:(0,f._)((0,p._)({},n),{tools:(0,g._)(null!==(e=n.tools)&&void 0!==e?e:[]).concat([{type:x.qK.PYTHON}])})})}E.current=G.length},[G.length]),(0,u.jsxs)("div",{className:"flex flex-col gap-4",children:[(k.length>0||P.length>0)&&(0,u.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-300",children:(0,u.jsx)(eT.Z,(0,p._)({},eC.knowledgeWarning))}),I.length>0||S.length>0?(0,u.jsxs)("div",{className:"flex flex-wrap gap-2",children:[I.map(s),S.map(l)]}):null,C.length>0||G.length>0?(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{className:"mb-2 text-xs text-gray-600 dark:text-gray-300",children:"The following files are only available for Code Interpreter:"}),(0,u.jsxs)("div",{className:"flex flex-wrap gap-2",children:[C.map(s),G.map(l)]})]}):null,(0,u.jsx)("div",{children:(0,u.jsxs)(ev.cY,{onClick:T,children:[(0,u.jsx)("input",(0,p._)({},N())),"Upload files"]})})]})}var eC=(0,$.vU)({knowledgeWarning:{id:"gizmo.knowledgeWarning",defaultMessage:"Conversations with your GPT may include file contents. Files can be downloaded when code interpreter is enabled.",description:"Explanation text for what happens when files are uploaded"}});function eI(e){var n=e.placeholder,t=e.text,i=e.onChange,r=e.onClose;return(0,u.jsx)(j.Z,{className:"!max-h-[100vh] !max-w-[80vw]",type:"success",isOpen:!0,onClose:r,primaryButton:(0,u.jsx)(ev.cY,{onClick:r,children:"Close"}),children:(0,u.jsx)("textarea",{className:"h-[70vh] w-full resize-none rounded-lg dark:border-gray-700 dark:bg-gray-800",value:t,onChange:function(e){i(e.target.value)},placeholder:n})})}function eM(e){var n=e.label,t=e.toolType,i=e.enabledTools,r=e.onEnabledToolsChange,o=e.disabled,a=e.disabledTooltip,s=function(e){return i.some(function(n){return n.type===e})},l=(0,u.jsx)(ev.f8,{labelClassName:"w-full cursor-pointer",id:t,label:n,checked:!o&&s(t),disabled:o,onChange:function(){s(t)?r(i.filter(function(e){return e.type!==t})):r((0,g._)(i).concat([{type:t}]))}});return null!=a?(0,u.jsx)("div",{className:"opacity-70",children:(0,u.jsx)(er.u,{side:"top",label:a,children:l})}):l}function eG(e){var n=e.enabledTools,t=e.onEnabledToolsChange,i=(0,y.C)(G.L0.BrowseAvailable);return(0,u.jsxs)("div",{className:"flex flex-col items-start gap-2",children:[(0,u.jsx)(eM,{label:"Web Browsing",toolType:x.qK.BROWSER,enabledTools:n,onEnabledToolsChange:t,disabled:!i,disabledTooltip:i?void 0:(0,u.jsx)(eT.Z,(0,p._)({},eS.disabledBrowsingToolTip))}),(0,u.jsx)(eM,{label:"DALL\xb7E Image Generation",toolType:x.qK.DALLE,enabledTools:n,onEnabledToolsChange:t}),(0,u.jsx)(eM,{label:(0,u.jsxs)("div",{className:"flex items-center",children:["Code Interpreter",(0,u.jsx)(eW,{description:"Code Interpreter lets your GPT run code. When enabled, your GPT can analyze data, work with files you've uploaded, do math and more"})]}),toolType:x.qK.PYTHON,enabledTools:n,onEnabledToolsChange:t})]})}var eS=(0,$.vU)({disabledBrowsingToolTip:{defaultMessage:"Web browsing is disabled for your workspace. Contact your admin to enable it.",id:"GizmoEditorModelPicker.disabledBrowsingToolTip",description:"Web browsing disable tooltip"}}),eE=t(42786);function eA(e){switch(e){case a.Loading:return"Loading";case a.UploadingProfilePic:return"Uploading profile picture";case a.GeneratingProfilePic:return"Generating profile picture";case a.GizmoNameTooLong:return"GPT name too long";case a.GizmoDescriptionTooLong:return"GPT description too long";case a.GizmoWelcomeMessageTooLong:return"GPT welcome message too long";case a.GizmoInstructionsTooLong:return"GPT instructions too long";case a.NameEmpty:return"GPT name cannot be empty";case a.MissingPublicActionPrivacyPolicyURL:return"Public actions require valid privacy policy URLs";default:return(0,eE.Z)(e),""}}function eL(e,n){var t=e.name.length>eo.aI,i=(null!==(h=null===(m=e.description)||void 0===m?void 0:m.length)&&void 0!==h?h:0)>eo.P_,r=(null!==(g=null===(p=e.welcomeMessage)||void 0===p?void 0:p.length)&&void 0!==g?g:0)>eo.Lu,o=(null!==(v=null===(f=e.instructions)||void 0===f?void 0:f.length)&&void 0!==v?v:0)>eo.vi,s=[];if((null==e?void 0:e.name)===""&&s.push(a.NameEmpty),t&&s.push(a.GizmoNameTooLong),i&&s.push(a.GizmoDescriptionTooLong),o&&s.push(a.GizmoInstructionsTooLong),r&&s.push(a.GizmoWelcomeMessageTooLong),null!=n&&[C.Zz.Link,C.Zz.Marketplace].includes(n)){var l=null===(y=e.tools)||void 0===y?void 0:y.filter(function(e){return e.type===x.qK.JIT_PLUGIN}),c=!0,u=!1,d=void 0;try{for(var m,p,f,h,g,v,y,b,j=l[Symbol.iterator]();!(c=(b=j.next()).done);c=!0){var _,w=b.value,N=null===(_=w.metadata)||void 0===_?void 0:_.privacy_policy_url;if(null==N||!function(e){try{return new URL(e),!0}catch(e){return!1}}(N)){s.push(a.MissingPublicActionPrivacyPolicyURL);break}}}catch(e){u=!0,d=e}finally{try{c||null==j.return||j.return()}finally{if(u)throw d}}}return s}function eU(){var e=(0,N._)(["w-full resize-none overflow-y-auto rounded-lg px-3 py-2 text-sm outline-none focus:ring-2 border focus:ring-blue-400 border-token-border-medium dark:bg-gray-700 h-9 dark:bg-gray-800"]);return eU=function(){return e},e}function eD(){var e=(0,N._)(["text-sm text-red-500"]);return eD=function(){return e},e}function eZ(){var e=(0,N._)(["mb-6"]);return eZ=function(){return e},e}function eR(){var e=(0,N._)(["w-full text-sm overflow-y-auto rounded-lg border bg-transparent px-3 py-2 focus:ring-2 focus:ring-blue-400 border-token-border-medium dark:bg-gray-800 bg-white h-32"]);return eR=function(){return e},e}(i=a||(a={}))[i.Loading=0]="Loading",i[i.UploadingProfilePic=1]="UploadingProfilePic",i[i.GeneratingProfilePic=2]="GeneratingProfilePic",i[i.GizmoNameTooLong=3]="GizmoNameTooLong",i[i.GizmoDescriptionTooLong=4]="GizmoDescriptionTooLong",i[i.GizmoWelcomeMessageTooLong=5]="GizmoWelcomeMessageTooLong",i[i.GizmoInstructionsTooLong=6]="GizmoInstructionsTooLong",i[i.NameEmpty=7]="NameEmpty",i[i.MissingPublicActionPrivacyPolicyURL=8]="MissingPublicActionPrivacyPolicyURL";var eO=T.Z.input(eU()),eV=T.Z.div(eD()),eJ=T.Z.div(eZ()),eq=T.Z.textarea(eR());function eB(){return(0,u.jsx)("div",{className:"ml-2 flex h-3.5 w-3.5 cursor-default items-center justify-center rounded-full border border-token-border-medium text-[0.5rem] font-medium leading-none text-gray-500 ",children:"?"})}function eW(e){var n=e.description;return(0,u.jsx)(er.u,{label:n,delayDuration:0,children:(0,u.jsx)(eB,{})})}function eF(e){var n=e.label,t=e.description,i=e.collapsed,r=e.onClick,o=(0,u.jsx)("label",{className:"block font-medium text-token-text-primary",children:n});return(0,u.jsxs)("div",{className:"mb-1.5 flex items-center",onClick:r,children:[void 0!==i&&(i?(0,u.jsx)(eN.H_v,{}):(0,u.jsx)(eN.iUH,{})),t?(0,u.jsx)(er.u,{label:t,sideOffset:4,side:"top",delayDuration:0,children:o}):(0,u.jsx)(u.Fragment,{children:o})]})}function eH(e){var n=e.children,t=e.collapsed,i=e.initial;return(0,u.jsx)(e_.M,{initial:i,children:!t&&(0,u.jsx)(ew.E.div,{initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},children:n})})}function eK(e){var n,t=e.actionTool,i=e.onShowActionsEditor,r=e.isDisabled,o="metadata"in t?null===(n=t.metadata)||void 0===n?void 0:n.domain:void 0;return(0,u.jsxs)("div",{className:"flex rounded-lg border border-token-border-medium text-sm hover:cursor-pointer",onClick:i,children:[(0,u.jsx)("div",{className:"h-9 grow px-3 py-2",children:null!=o?o:(0,u.jsx)("span",{className:"text-red-500",children:"Invalid action"})}),(0,u.jsx)("div",{className:"w-px border border-token-border-medium"}),(0,u.jsx)("button",{disabled:r,className:"flex h-9 w-9 items-center justify-center rounded-lg rounded-l-none",children:(0,u.jsx)(K.RR,{className:"icon-sm"})})]})}function eQ(e){var n,t,i,r=e.gizmo,o=e.onShowActionsEditor,a=e.isDisabled,s=(0,B.Z)(),l=(0,u.jsxs)("div",{className:"space-y-1",children:[null==r?void 0:null===(n=r.tools)||void 0===n?void 0:n.map(function(e,n){var t;return e.type!==x.qK.JIT_PLUGIN?null:(0,u.jsxs)("div",{children:[(0,u.jsx)(eK,{isDisabled:a,actionTool:e,onShowActionsEditor:function(){return o(e.metadata.domain)}}),(null===(t=e.metadata.auth)||void 0===t?void 0:t.type)==="oauth"&&(0,u.jsx)(ei.Z,{label:"Callback URL",value:"".concat("https://chat.openai.com","/aip/").concat(e.metadata.action_id,"/oauth/callback"),onCopied:function(){M.m.success("Copied to clipboard",{duration:3})}})]},n)}),(null!==(i=null==r?void 0:null===(t=r.tools)||void 0===t?void 0:t.filter(function(e){return e.type===x.qK.JIT_PLUGIN}))&&void 0!==i?i:[]).length>=eo.L5?(0,u.jsx)("div",{children:s.formatMessage(eY.maxActionsReached,{number:eo.L5})}):(0,u.jsx)(ev.cY,{disabled:a,onClick:function(){o("Unknown domain")},className:"mt-2",children:(0,u.jsx)(eT.Z,(0,p._)({},eY.createActionLabel))})]});return a?(0,u.jsx)(er.u,{side:"top",label:s.formatMessage(eY.disabledCustomActionsTooltip),children:l}):l}function eX(e){var n,t,i,r,o,s,l,c,d,b,j,_=e.gizmoEditorData,w=e.updateGizmo,N=e.generateProfilePic,T=e.setIsUploadingProfilePic,P=e.isGeneratingProfilePic,k=e.setIsGeneratingProfilePic,z=e.requireGizmoId,C=e.onShowActionsEditor,I=(0,eb.B9)(),M=eb.mx,S=null!==(o=null==_?void 0:_.tools)&&void 0!==o?o:[],A=M?I.get(M):void 0,L=(0,h._)((0,D.useState)(!1),2),U=L[0],Z=L[1],R=(0,h._)((0,D.useState)(!1),2),J=R[0],q=R[1],W=(0,h._)((0,D.useState)(!0),2),F=W[0],H=W[1],Q=null!==(s=null==_?void 0:_.promptStarters)&&void 0!==s?s:[],X=(0,g._)(Q).concat((0,g._)(Q.length<12?[""]:[])),Y=eL(_),$=(0,E.ec)(E.F_.isBusinessWorkspace),ee=(0,y.C)(G.L0.WorkspaceGPTCustomActions),en=(0,B.Z)();return(0,u.jsxs)("div",{className:"flex h-full grow flex-col overflow-y-auto px-2 pt-6 text-sm",children:[(0,u.jsxs)("div",{className:"grow",children:[(0,u.jsxs)(eJ,{children:[(0,u.jsx)(ey,{gizmoEditorData:_,generateProfilePic:N,isGeneratingProfilePic:P,setIsGeneratingProfilePic:k,onFileChange:(n=(0,m._)(function(e){var n;return(0,v.Jh)(this,function(t){switch(t.label){case 0:if(!(null!=e&&"uploading"!==e&&null!=e.fileId))return[3,2];return[4,ej.ZP.getFileDownloadLink(e.fileId)];case 1:return(n=t.sent()).status===x.KF.Success&&w({profilePictureId:null!=e.fileId?e.fileId:void 0,profilePictureUrl:n.download_url}),[3,3];case 2:w({profilePictureId:void 0,profilePictureUrl:void 0}),t.label=3;case 3:return T("uploading"===e),[2]}})}),function(e){return n.apply(this,arguments)})}),(0,u.jsx)(eF,{label:"Name",description:"The name of your GPT"}),(0,u.jsx)(eO,{type:"text",placeholder:"Name your GPT",value:null!==(l=null==_?void 0:_.name)&&void 0!==l?l:"",onChange:function(e){w({name:e.target.value})},onBlurCapture:function(){return w(function(e){return(0,f._)((0,p._)({},e),{name:e.name.trim()})})}}),Y.includes(a.GizmoNameTooLong)?(0,u.jsx)(eV,{className:"mt-1",children:(0,u.jsx)(eT.Z,(0,f._)((0,p._)({},eY.nameTooLong),{values:{length:eo.aI}}))}):null]}),(0,u.jsxs)(eJ,{className:"mt-4",children:[(0,u.jsx)(eF,{label:"Description",description:"Short description of what this GPT does"}),(0,u.jsx)(eO,{type:"text",placeholder:"Add a short description about what this GPT does",value:null!==(c=null==_?void 0:_.description)&&void 0!==c?c:"",onChange:function(e){return w({description:e.target.value})},onBlurCapture:function(){return w(function(e){var n;return(0,f._)((0,p._)({},e),{description:null!==(d=null===(n=e.description)||void 0===n?void 0:n.trim())&&void 0!==d?d:""})})}}),Y.includes(a.GizmoDescriptionTooLong)?(0,u.jsx)(eV,{className:"mt-1",children:(0,u.jsx)(eT.Z,(0,f._)((0,p._)({},eY.descriptionTooLong),{values:{length:eo.P_}}))}):null]}),(0,u.jsxs)(eJ,{children:[(0,u.jsx)(eF,{label:"Instructions",description:"What does this GPT do? How does it behave? What should it avoid doing?"}),(0,u.jsxs)("div",{className:"relative",children:[(0,u.jsx)(eq,{className:"resize-none",rows:8,value:null==_?void 0:_.instructions,onChange:function(e){return w({instructions:e.target.value})},onBlurCapture:function(){return w(function(e){return(0,f._)((0,p._)({},e),{instructions:e.instructions.trim()})})},placeholder:"What does this GPT do? How does it behave? What should it avoid doing?"}),(0,u.jsx)("button",{className:"absolute bottom-3 right-2 text-token-text-tertiary",onClick:function(){return Z(!0)},children:(0,u.jsx)(K.j5,{className:"icon-sm"})})]}),Y.includes(a.GizmoInstructionsTooLong)?(0,u.jsx)(eV,{className:"mt-1",children:(0,u.jsx)(eT.Z,(0,f._)((0,p._)({},eY.instructionsTooLong),{values:{length:eo.vi}}))}):null]}),(0,u.jsxs)(eJ,{className:"hidden",children:[(0,u.jsx)(eF,{label:"Welcome Message",description:"How this GPT starts conversations."}),(0,u.jsxs)("div",{className:"relative",children:[(0,u.jsx)(eq,{className:(0,O.default)("h-16 resize-none"),value:null==_?void 0:_.welcomeMessage,onChange:function(e){return w({welcomeMessage:e.target.value})},placeholder:"How this GPT starts conversations."}),(0,u.jsx)("button",{className:"absolute bottom-3 right-2 text-token-text-tertiary",onClick:function(){return q(!0)},children:(0,u.jsx)(K.j5,{className:"icon-sm"})})]}),Y.includes(a.GizmoWelcomeMessageTooLong)?(0,u.jsx)(eV,{className:"mt-1",children:(0,u.jsx)(eT.Z,(0,f._)((0,p._)({},eY.welcomeMessageTooLong),{values:{length:eo.Lu}}))}):null]}),(0,u.jsxs)(eJ,{children:[(0,u.jsx)(eF,{label:"Conversation starters",description:"Examples for the user to start the conversation"}),(0,u.jsx)("div",{className:"flex flex-col gap-1",children:X.map(function(e,n){return(0,u.jsxs)("div",{className:"flex items-center",children:[(0,u.jsx)(eO,{className:"rounded-r-none",value:e,type:"text",onChange:function(e){var t,i=e.target.value;w(function(e){return(0,f._)((0,p._)({},e),{promptStarters:(0,V.compact)(n>=(null!==(t=Q.length)&&void 0!==t?t:0)?(0,g._)(null!=Q?Q:[]).concat([i]):Q.map(function(e,t){if(t===n){if(""===i)return;return i}return e}))})})}}),(0,u.jsx)("button",{className:"flex h-9 w-9 items-center justify-center rounded-lg rounded-l-none border border-l-0 border-token-border-medium",onClick:function(){return w(function(e){return(0,f._)((0,p._)({},e),{promptStarters:Q.filter(function(e,t){return t!==n})})})},children:(0,u.jsx)(K.v7,{className:"icon-sm"})})]},n)})})]}),(0,u.jsxs)(eJ,{children:[(0,u.jsx)(eF,{label:"Knowledge",description:en.formatMessage(eY.knowledgeExplanation)}),(0,u.jsx)(ez,{gizmoEditorData:_,requireGizmoId:z,currentModelConfig:A,updateGizmo:w})]}),(0,u.jsxs)(eJ,{children:[(0,u.jsx)(eF,{label:"Capabilities",description:"Functionality this GPT can use"}),(0,u.jsx)(eG,{enabledTools:S,onEnabledToolsChange:function(e){return w({tools:e})}})]}),(0,u.jsxs)(eJ,{children:[(0,u.jsx)(eF,{label:"Actions",description:"APIs this GPT can use"}),(0,u.jsx)(eQ,{isDisabled:!!($&&!ee),gizmo:_,onShowActionsEditor:C})]}),!$&&((null!==(r=null===(t=_.files)||void 0===t?void 0:t.length)&&void 0!==r?r:0)>0||(null==_?void 0:null===(i=_.tools)||void 0===i?void 0:i.some(function(e){return e.type===x.qK.JIT_PLUGIN})))&&(0,u.jsxs)(eJ,{children:[(0,u.jsx)(eF,{label:"Additional Settings",collapsed:!!F,onClick:function(){H(function(e){return!e})}}),(0,u.jsx)(eH,{collapsed:F,initial:!1,children:(0,u.jsx)(ev.f8,{className:"mx-3 my-1",labelClassName:"w-full cursor-pointer",label:"Use conversation data in your GPT to improve our models",id:"improve-chatgpt",checked:!_.trainingDisabled,onChange:function(){w({trainingDisabled:!_.trainingDisabled})}})})]})]}),J&&(0,u.jsx)(eI,{text:null!==(b=_.welcomeMessage)&&void 0!==b?b:"",onChange:function(e){w({welcomeMessage:e})},onClose:function(){return q(!1)},placeholder:"How this GPT starts conversations."}),U&&(0,u.jsx)(eI,{text:null!==(j=_.instructions)&&void 0!==j?j:"",onChange:function(e){w({instructions:e})},onClose:function(){return Z(!1)},placeholder:"What does this GPT do? How does it behave? What should it avoid doing?"})]})}var eY=(0,$.vU)({nameTooLong:{id:"gizmo.nameTooLong",defaultMessage:"GPT names cannot be longer than {length} characters.",description:"Error message when name is too long"},knowledgeExplanation:{id:"gizmo.knowledgeExplanation",defaultMessage:"Additional files for this GPT to reference.",description:"Explainer text around what happens when your files upload."},descriptionTooLong:{id:"gizmo.descriptionTooLong",defaultMessage:"GPT descriptions cannot be longer than {length} characters.",description:"Error message when description is too long"},instructionsTooLong:{id:"gizmo.instructionsTooLong",defaultMessage:"GPT instructions cannot be longer than {length} characters.",description:"Error message when instructions are too long"},welcomeMessageTooLong:{id:"gizmo.welcomeMessageTooLong",defaultMessage:"GPT welcome messages cannot be longer than {length} characters.",description:"Error message when welcome message is too long"},disabledCustomActionsTooltip:{id:"gizmo.disabledCustomActionsTooltip",defaultMessage:"Custom actions are disabled for your workspace. Contact your admin to enable them.",description:"Tooltip label when custom actions are are disabled"},createActionLabel:{id:"gizmo.createActionLabel",defaultMessage:"Create new action",description:"Label for button to create a new action"},maxActionsReached:{id:"gizmo.maxActionsReached",defaultMessage:"GPTs can have a maximum of {number} actions",description:"Message when maximum number of actions has been reached"}}),e$=t(73960),e0=t(67013);function e1(e){var n=e.clientThreadId,t=(0,S.oq)(n),i=(0,S.U0)(n,t),r=(0,S.Ro)(n),o=(0,g._)(Array(i).keys()).map(function(e){var o;return(0,u.jsx)(e0.Z,{isFinalTurn:e===i-1,turnIndex:e,clientThreadId:n,conversationLeafId:t,onChangeItemInView:V.noop,onChangeRating:V.noop,onRequestMoreCompletions:V.noop,onRequestCompletion:V.noop,currentModelId:null!==(o=null==r?void 0:r.id)&&void 0!==o?o:""},e)});return(0,u.jsx)(u.Fragment,{children:o})}function e2(e){var n=e.clientThreadIds;return(0,u.jsx)(u.Fragment,{children:n.map(function(e){return(0,u.jsx)(e1,{clientThreadId:e},e)})})}var e3=t(47478),e4=t(12176),e5=t(45567),e7=t(68699),e8=t(55548),e6=t(84844),e9=t(4263),ne=t(2064),nn=t(8844),nt=t(9304),ni=t(5306),nr=t(15372);function no(){return(0,u.jsxs)("div",{className:"flex items-center",children:[(0,u.jsx)("div",{className:"border-token-border-secondary flex-grow border-b"}),(0,u.jsxs)("div",{className:"flex flex-shrink-0 items-center gap-2 px-2 py-6 text-sm text-token-text-tertiary",children:[(0,u.jsx)(el.V7f,{}),"GPT updated"]}),(0,u.jsx)("div",{className:"border-token-border-secondary flex-grow border-b"})]})}(r=s||(s={}))[r.MAGIC=1]="MAGIC",r[r.SANDBOX=2]="SANDBOX",(l||(l={})).TestGizmoAction="test_gizmo_action";var na=new e9.V,ns=D.memo(function(e){var n,t,i,r=e.gizmoEditorData,o=e.isSavingDraft,a=e.showTitle,s=(0,h._)((0,D.useState)(function(){return(0,S.OX)()}),2),l=s[0],c=s[1],d=(0,h._)((0,D.useState)([]),2),p=d[0],f=d[1];(0,D.useEffect)(function(){f(function(e){return e[e.length-1]===l?e:(0,g._)(e).concat([l])})},[l]);var x=p.slice(0,-1);(0,S.ax)(l);var y=(0,S.UL)(l);(0,D.useEffect)(function(){null!=r.id&&S.tQ.setNewThreadConversationModeMetadata(l,{kind:F.OL.GizmoTest,gizmo_id:r.id})},[l,r.id]);var b=null===(i=r.files)||void 0===i?void 0:i.map(function(e){return e.file_id}).join();(0,D.useEffect)(function(){null!=S.tQ.getServerThreadId(l)&&c((0,S.OX)())},[r.id,r.instructions,r.welcomeMessage,r.tools,b,l]),(0,D.useEffect)(function(){(0,S.Zz)(l)&&S.iN.hasThread(l)&&y.lastModelUsed!==eb.mx&&(S.tQ.getOrInitThread(l),S.tQ.updateInitialThreadDataForNewThread(l,eb.mx,[]))},[l,y,r]);var j=(0,e8.tN)(function(e){return e.activeSidebar}),_=(0,D.useMemo)(function(){return{gizmoEditorData:r,mode:"test"}},[r]),w=(0,h._)((0,D.useState)(0),2),N=w[0],T=w[1],P=function(){T(function(e){return e-360})},k=r.id,z=(t=(0,nt.Z)(l,void 0,V.noop,V.noop,V.noop,[]),(0,D.useCallback)((n=(0,m._)(function(e,n,i){var r,o,a,s,c,u;return(0,v.Jh)(this,function(d){switch(d.label){case 0:if(r=S.tQ.getThreadCurrentLeafId(l),o=(0,nn.Z)(),S.tQ.updateTree(l,function(e){e.addNodeToEnd(r,{id:o,children:[],parentId:r,message:{id:o,author:{role:F.uU.User},content:{content_type:F.PX.Text,parts:["Call the ".concat(n," API with the ").concat(i," operation")]},recipient:"all",metadata:{jit_plugin_data:{from_client:{user_action:{data:{type:"test",operation:i,tool_name:(0,e$.VN)(n)}}}}}}})}),a={conversationMode:{kind:F.OL.GizmoTest,gizmo_id:e}},s=[eb.S.GPT_4],c=(0,ne.Rr)((0,e7.N$)(),s,F.OL.GizmoTest),u=null,!c)return[3,2];return[4,ne.ZP.getEnforcementToken(s)];case 1:u=d.sent(),d.label=2;case 2:return t({model:eb.mx,completionType:F.Os.Next,parentNodeId:o,metadata:{},focusOnNewCompletion:!0,arkoseToken:u,preflightTime:0,completionMetadata:a,extraStreamParams:{}}),[2]}})}),function(e,t,i){return n.apply(this,arguments)}),[l,t]));return(0,D.useEffect)(function(){return(0,e6.LW)(na,{test_gizmo_action:function(e){var n=e.rootDomain,t=e.operationName;k&&z(k,n,t)}})},[z,k]),(0,u.jsx)(ni.D.Provider,{value:_,children:(0,u.jsxs)("div",{className:(0,O.default)("flex h-full w-full",o&&"cursor-wait opacity-80 transition"),children:[(0,u.jsxs)("div",{className:"flex grow flex-col",children:[(0,u.jsx)("div",{className:"relative mb-2 flex-shrink-0",children:(0,u.jsx)("div",{className:"flex justify-center py-1",children:(void 0===a||a)&&(0,u.jsxs)("div",{className:"group flex items-center gap-2 text-lg font-medium",children:[(0,u.jsx)("div",{className:"icon-md"}),(0,u.jsxs)("button",{onClick:function(){P(),f([]),c((0,S.OX)())},className:"flex items-center gap-2",children:["Preview",(0,u.jsx)(ew.E.div,{className:"text-token-text-primary",animate:{rotate:N},transition:{duration:.3},children:(0,u.jsx)(K.u8,{className:"icon-md invisible group-hover:visible"})})]})]})})}),(0,u.jsx)("div",{className:(0,O.default)("relative grow overflow-auto px-2",o&&"pointer-events-none"),children:(0,u.jsx)(e4.Z,{initialThreadData:y,clientThreadId:l,hideHeader:!0,renderEmptyState:(0,u.jsxs)("div",{className:"relative h-full w-full",children:[null!=x&&x.length>0&&(0,u.jsx)("div",{className:"h-full w-full opacity-20",children:(0,u.jsxs)(e5.I,{children:[(0,u.jsx)(e2,{clientThreadIds:x}),(0,u.jsx)(no,{})]})}),(0,u.jsx)("div",{className:"absolute left-0 top-0 h-full w-full",children:(0,u.jsx)(nr.r,{gizmo:r,isOwner:!0,hideOwner:!0})})]}),prependThreadChildren:x.length>0&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"opacity-50",children:(0,u.jsx)(e2,{clientThreadIds:x})}),(0,u.jsx)(no,{})]})})})]}),"debug"===j&&(0,u.jsx)(e3.fv,{clientThreadId:l,slideOver:!1,onClose:function(){return e8.vm.toggleActiveSidebar("debug")},isOpen:!0})]})})});function nl(e){var n=e.children;return(0,u.jsx)("label",{className:"mb-1 block text-sm font-medium",children:n})}function nc(e){var n,t,i,r,o,a,s,l,c,d,m,f,g,v,x,y,b,_,w,N,T,P=e.jitPluginTool,k=e.onUpdateTool,z=e.onClose,C=function(e){S(function(n){return(0,p._)({},n,e)})},I=function(){k(G.authTypeValue===F.Jv.None?{type:F.Jv.None}:G.authTypeValue===F.Jv.OAuth?{type:F.Jv.OAuth,client_url:G.oauthAuthUrlValue,authorization_url:G.oauthTokenUrlValue,authorization_content_type:"application/x-www-form-urlencoded",scope:G.oauthScopeValue,token_exchange_method:G.tokenExchangeMethodValue,oauth_client_id:G.oauthClientIdValue,oauth_client_secret:G.oauthClientSecretValue}:{type:F.Jv.ServiceHTTP,authorization_type:G.httpAuthTypeValue,custom_auth_header:G.customHeaderValue,api_key:G.apiKeyValue}),z()},M=(0,h._)((0,D.useState)({apiKeyValue:"",oauthClientIdValue:"",oauthClientSecretValue:"",oauthAuthUrlValue:null!==(x=null==P?void 0:null===(n=P.metadata)||void 0===n?void 0:null===(t=n.auth)||void 0===t?void 0:t.client_url)&&void 0!==x?x:"",oauthTokenUrlValue:null!==(y=null==P?void 0:null===(i=P.metadata)||void 0===i?void 0:null===(r=i.auth)||void 0===r?void 0:r.authorization_url)&&void 0!==y?y:"",oauthScopeValue:null!==(b=null==P?void 0:null===(o=P.metadata)||void 0===o?void 0:null===(a=o.auth)||void 0===a?void 0:a.scope)&&void 0!==b?b:"",authTypeValue:null!==(_=null==P?void 0:null===(s=P.metadata)||void 0===s?void 0:null===(l=s.auth)||void 0===l?void 0:l.type)&&void 0!==_?_:F.Jv.None,httpAuthTypeValue:null!==(w=null==P?void 0:null===(c=P.metadata)||void 0===c?void 0:null===(d=c.auth)||void 0===d?void 0:d.authorization_type)&&void 0!==w?w:"basic",customHeaderValue:null!==(N=null==P?void 0:null===(m=P.metadata)||void 0===m?void 0:null===(f=m.auth)||void 0===f?void 0:f.custom_auth_header)&&void 0!==N?N:"",tokenExchangeMethodValue:null!==(T=null==P?void 0:null===(g=P.metadata)||void 0===g?void 0:null===(v=g.auth)||void 0===v?void 0:v.token_exchange_method)&&void 0!==T?T:"default_post"}),2),G=M[0],S=M[1];return(0,u.jsxs)(j.Z,{type:"success",isOpen:!0,title:"Authentication",primaryButton:(0,u.jsx)(H.z,{color:"dark",onClick:function(){I()},children:"Save"}),secondaryButton:(0,u.jsx)(H.z,{color:"neutral",onClick:z,children:"Cancel"}),onClose:z,children:[(0,u.jsxs)("div",{className:"mb-4",children:[(0,u.jsx)(nl,{children:"Authentication Type"}),(0,u.jsxs)(X.Root,{onValueChange:function(e){C({authTypeValue:e})},value:G.authTypeValue,className:"flex gap-4",children:[(0,u.jsx)(ev.Xb,{label:"None",value:F.Jv.None}),(0,u.jsx)(ev.Xb,{label:"API Key",value:F.Jv.ServiceHTTP}),(0,u.jsx)(ev.Xb,{label:"OAuth",value:F.Jv.OAuth})]})]}),"service_http"===G.authTypeValue?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(nl,{children:"API Key"}),(0,u.jsx)(eO,{placeholder:"<HIDDEN>",type:"password",value:G.apiKeyValue,onChange:function(e){C({apiKeyValue:e.target.value})},className:"mb-2"}),(0,u.jsx)(nl,{children:"Auth Type"}),(0,u.jsxs)(X.Root,{className:"mb-2 flex gap-6 overflow-hidden rounded-lg",value:G.httpAuthTypeValue,required:!0,onValueChange:function(e){C({httpAuthTypeValue:e})},children:[(0,u.jsx)(ev.Xb,{value:"basic",label:"Basic"}),(0,u.jsx)(ev.Xb,{value:"bearer",label:"Bearer"}),(0,u.jsx)(ev.Xb,{value:"custom",label:"Custom"})]}),"custom"===G.httpAuthTypeValue&&(0,u.jsxs)("div",{className:"mt-2",children:[(0,u.jsx)(nl,{children:"Custom Header Name"}),(0,u.jsx)(eO,{value:G.customHeaderValue,onChange:function(e){C({customHeaderValue:e.target.value})},className:"mb-2",placeholder:"X-Api-Key"})]})]}):"oauth"===G.authTypeValue?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(nl,{children:"Client ID"}),(0,u.jsx)(eO,{placeholder:"<HIDDEN>",type:"password",value:G.oauthClientIdValue,onChange:function(e){C({oauthClientIdValue:e.target.value})},className:"mb-2"}),(0,u.jsx)(nl,{children:"Client Secret"}),(0,u.jsx)(eO,{placeholder:"<HIDDEN>",type:"password",value:G.oauthClientSecretValue,onChange:function(e){C({oauthClientSecretValue:e.target.value})},className:"mb-2"}),(0,u.jsx)(nl,{children:"Authorization URL"}),(0,u.jsx)(eO,{value:G.oauthAuthUrlValue,onChange:function(e){C({oauthAuthUrlValue:e.target.value})},className:"mb-2"}),(0,u.jsx)(nl,{children:"Token URL"}),(0,u.jsx)(eO,{value:G.oauthTokenUrlValue,onChange:function(e){C({oauthTokenUrlValue:e.target.value})},className:"mb-2"}),(0,u.jsx)(nl,{children:"Scope"}),(0,u.jsx)(eO,{value:G.oauthScopeValue,onChange:function(e){C({oauthScopeValue:e.target.value})},className:"mb-2"}),(0,u.jsx)(nl,{children:"Token Exchange Method"}),(0,u.jsxs)(X.Root,{value:G.tokenExchangeMethodValue,required:!0,onValueChange:function(e){C({tokenExchangeMethodValue:e})},children:[(0,u.jsx)(ev.Xb,{value:"default_post",label:"Default (POST request)"}),(0,u.jsx)(ev.Xb,{value:"basic_auth_header",label:"Basic authorization header"})]})]}):null]})}function nu(e){var n=e.onImport,t=e.onClose,i=(0,h._)((0,D.useState)(""),2),r=i[0],o=i[1],a=(0,h._)((0,D.useState)(!1),2),s=a[0],l=a[1];function c(){return(c=(0,m._)(function(){var e;return(0,v.Jh)(this,function(i){switch(i.label){case 0:try{e=new URL(r)}catch(e){return[2]}if(!(null==e?void 0:e.hostname))return[3,4];l(!0),i.label=1;case 1:return i.trys.push([1,,3,4]),[4,_.U.fetchOpenAPISpec(r)];case 2:return n(i.sent().content),t(),[3,4];case 3:return l(!1),[7];case 4:return[2]}})})).apply(this,arguments)}return(0,u.jsxs)("div",{className:"flex items-center gap-2",children:[(0,u.jsx)("input",{name:"url",value:r,onChange:function(e){o(e.target.value)},placeholder:"https://...",className:"h-8 rounded border border-token-border-light px-2 text-sm",autoFocus:!0}),(0,u.jsx)(ev.cY,{color:"dark",loading:s,onClick:function(){return c.apply(this,arguments)},children:"Import"}),(0,u.jsx)(ev.cY,{color:"neutral",onClick:t,children:"Cancel"})]})}function nd(e){var n=e.rootDomain,t=e.operations;return null==t||0===t.length?(0,u.jsx)("div",{className:"text-sm text-token-text-tertiary",children:"Operations in your schema will show here."}):(0,u.jsx)("table",{className:"w-full text-sm",children:(0,u.jsxs)("tbody",{children:[(0,u.jsxs)("tr",{className:"border-b border-token-border-light text-left text-xs text-token-text-tertiary",children:[(0,u.jsx)("th",{className:"py-1 font-normal",children:"Name"}),(0,u.jsx)("th",{className:"py-1 font-normal",children:"Method"}),(0,u.jsx)("th",{className:"py-1 font-normal",children:"Path"}),(0,u.jsx)("th",{className:"py-1 font-normal"})]}),t.map(function(e){return(0,u.jsxs)("tr",{className:"border-b border-token-border-light",children:[(0,u.jsx)("td",{className:"py-2",children:e.operationName}),(0,u.jsx)("td",{className:"py-2 uppercase",children:e.method}),(0,u.jsx)("td",{className:"py-2",children:e.path}),(0,u.jsx)("td",{className:"py-2",children:(0,u.jsx)(ev.cY,{color:"neutral",onClick:function(){n&&na.publish({kind:l.TestGizmoAction,rootDomain:n,operationName:e.operationName})},children:"Test"})})]},e.operationName)})]})})}function nm(e){var n=e.validationResponse;return(0,u.jsxs)("div",{children:[(0,u.jsx)(eF,{label:"Available actions"}),(0,u.jsx)(nd,{rootDomain:n.success?n.spec.root_domain:void 0,operations:n.success?n.spec.operations:void 0})]})}function np(e){var n,t,i,r,o,a,s,l,c=e.currentlyEditingActionDomain,d=e.gizmoEditorData,y=e.updateGizmo,b=e.onClose,j=function(e){y(function(n){return(0,f._)((0,p._)({},n),{tools:k?n.tools.map(function(n){return n.type===x.qK.JIT_PLUGIN&&n.metadata.domain===N?(0,f._)((0,p._)({},n),{metadata:(0,p._)({},n.metadata,e)}):n}):(0,g._)(n.tools).concat([{type:x.qK.JIT_PLUGIN,metadata:(0,p._)({raw_spec:"",domain:null!=N?N:"Unknown domain",action_id:""},e)}])})})},w=(0,h._)((0,D.useState)(c),2),N=w[0],T=w[1],P=(0,D.useRef)(N);(0,D.useEffect)(function(){P.current=N},[N]);var k=null==d?void 0:null===(n=d.tools)||void 0===n?void 0:n.find(function(e){return e.type===x.qK.JIT_PLUGIN&&e.metadata.domain===N}),z=(0,h._)((0,D.useState)(function(){return null==k}),1)[0],C=null!==(a=null==k?void 0:null===(t=k.metadata)||void 0===t?void 0:t.raw_spec)&&void 0!==a?a:"",I=(0,h._)((0,D.useState)(!1),2),M=I[0],G=I[1],S=(0,h._)((0,D.useState)(!1),2),E=S[0],A=S[1],L=(0,h._)((0,D.useState)(),2),U=L[0],Z=L[1],R=(0,h._)((0,D.useState)(function(){var e;return(0,V.debounce)((e=(0,m._)(function(e){var n,t,i,r;return(0,v.Jh)(this,function(o){switch(o.label){case 0:return[4,_.U.validateOpenAPISpec(e)];case 1:if(Z(n=o.sent()),t=n.success?n.spec.root_domain:void 0){if(t!==P.current&&(null==d?void 0:null===(i=d.tools)||void 0===i?void 0:i.find(function(e){return e.type===x.qK.JIT_PLUGIN&&e.metadata.domain===t})))return Z({success:!1,errors:["Action sets cannot have duplicate domains - ".concat(t," already exists on another action")]}),[2];y(function(e){return(0,f._)((0,p._)({},e),{tools:e.tools.map(function(e){return e.type===x.qK.JIT_PLUGIN&&e.metadata.domain===P.current?(0,f._)((0,p._)({},e),{metadata:(0,f._)((0,p._)({},e.metadata),{domain:t})}):e})})}),T(t)}return n.success&&n.known_auth&&n.known_privacy_policy&&(r=(0,p._)({type:F.Jv.OAuth},n.known_auth),(0,V.isEqual)(k.metadata.auth,r)||j({auth:(0,p._)({type:F.Jv.OAuth},n.known_auth)}),k.metadata.privacy_policy_url!==n.known_privacy_policy&&j({privacy_policy_url:n.known_privacy_policy})),[2]}})}),function(n){return e.apply(this,arguments)}),1e3)}),1)[0],O=null!=U?U.success?U.warnings:U.errors:void 0;(0,D.useEffect)(function(){""===C?(Z(void 0),R.cancel()):R(C)},[R,C]);var J=(0,D.useMemo)(function(){try{return JSON.parse(C)}catch(e){return}},[C]);return(0,u.jsxs)("div",{className:"h-full overflow-auto px-4 pb-12 text-sm",children:[(0,u.jsxs)("div",{className:"relative flex flex-col items-center px-16 py-6 text-center",children:[(0,u.jsx)("div",{className:"absolute left-0 top-6",children:(0,u.jsx)(H.z,{color:"neutral",onClick:b,children:(0,u.jsx)(K.L7,{className:"icon-md"})})}),null!=k&&(0,u.jsx)("div",{className:"absolute right-0 top-6",children:(0,u.jsx)(H.z,{color:"neutral",onClick:function(){window.confirm("Are you sure you want to delete this action?")&&(y(function(e){return(0,f._)((0,p._)({},e),{tools:e.tools.filter(function(e){return e.type!==x.qK.JIT_PLUGIN||e.metadata.domain!==N})})}),b())},className:"text-red-500",children:(0,u.jsx)(K.a_,{className:"icon-md"})})}),(0,u.jsx)("div",{className:"text-xl font-medium",children:z?"Add actions":"Edit actions"}),(0,u.jsx)("div",{className:"text-sm text-token-text-tertiary",children:"Let your GPT retrieve information or take actions outside of ChatGPT."}),(0,u.jsx)("div",{className:"text-sm text-token-text-tertiary",children:(0,u.jsx)("a",{href:"https://help.openai.com/en/articles/8554397-creating-a-gpt",target:"_blank",rel:"noreferrer",className:"font-medium",children:"Learn more."})})]}),(0,u.jsxs)("div",{children:[(0,u.jsxs)("div",{className:"mb-1 flex h-8 items-center justify-between",children:[(0,u.jsx)("label",{className:"font-medium text-token-text-primary",children:"Schema"}),(0,u.jsx)("div",{className:"flex items-center",children:E?(0,u.jsx)(nu,{onImport:function(e){j({raw_spec:e})},onClose:function(){A(!1)}}):(0,u.jsxs)("div",{className:"flex items-center gap-2",children:[(0,u.jsx)(ev.cY,{color:"neutral",onClick:function(){A(!0)},children:"Import from URL"}),(0,u.jsx)(ee,{onSelectExample:function(e){j({raw_spec:e})}})]})})]}),(0,u.jsxs)("div",{className:"relative mb-8 overflow-hidden rounded-lg border border-token-border-light",children:[(0,u.jsx)("textarea",{value:C,onChange:function(e){j({raw_spec:e.target.value})},spellCheck:!1,placeholder:"Enter your OpenAPI schema here",className:"block h-96 w-full border-none bg-transparent p-2 font-mono text-sm text-token-text-primary"}),null!=O&&(null==O?void 0:O.length)>0&&(0,u.jsx)("div",{className:"border-t border-token-border-light p-2 text-red-500",children:O.map(function(e,n){return(0,u.jsx)("div",{children:e},n)})}),null!=J&&(0,u.jsx)("button",{onClick:function(){j({raw_spec:JSON.stringify(J,null,2)})},className:"absolute right-0 top-full text-xs text-token-text-tertiary transition hover:text-token-text-primary",children:"Format JSON"})]})]}),null!=U&&(0,u.jsx)(nm,{validationResponse:U}),(0,u.jsxs)(eJ,{className:"relative mt-4",children:[(0,u.jsx)(eF,{label:"Authentication"}),(0,u.jsx)(Y,{onClick:function(){G(!0)},content:function(e){switch(e){case F.Jv.None:return"None";case F.Jv.OAuth:return"OAuth";case F.Jv.ServiceHTTP:return"API Key"}}(null!==(s=null==k?void 0:null===(i=k.metadata)||void 0===i?void 0:null===(r=i.auth)||void 0===r?void 0:r.type)&&void 0!==s?s:F.Jv.None),button:(0,u.jsx)("button",{color:"neutral",className:"flex items-center gap-2 px-3",children:(0,u.jsx)(K.RR,{className:"icon-sm"})})}),M&&(0,u.jsx)(nc,{jitPluginTool:k,onUpdateTool:function(e){switch(e.type){case F.Jv.None:j({auth:{type:F.Jv.None}});break;case F.Jv.OAuth:var n=e.oauth_client_id,t=e.oauth_client_secret;j({auth:(0,W._)(e,["oauth_client_id","oauth_client_secret"]),oauth_client_id:n,oauth_client_secret:t});break;case F.Jv.ServiceHTTP:var i=e.api_key;j({auth:(0,W._)(e,["api_key"]),api_key:i})}},onClose:function(){G(!1)}})]}),(0,u.jsxs)("div",{className:"mt-4",children:[(0,u.jsx)(eF,{label:"Privacy policy",description:"Privacy policy is required for all public GPTs."}),(0,u.jsx)(Q.Z,{name:"privacyPolicyUrl",value:null!==(l=null==k?void 0:null===(o=k.metadata)||void 0===o?void 0:o.privacy_policy_url)&&void 0!==l?l:"",placeholder:"https://api.example-weather-app.com/privacy",onChange:function(e){j({privacy_policy_url:e.target.value})}})]})]})}var nf=t(81547),nh=t(6013),ng=t(38574),nv=t(73040),nx=t.n(nv),ny=t(37736);function nb(){var e=(0,N._)(["flex items-center gap-1"]);return nb=function(){return e},e}function nj(e){var n,t=e.gizmo,i=e.promoteGizmo,r=e.setStep,o=e.showActionsModal,s=(0,h._)((0,D.useState)(!1),2),l=s[0],c=s[1],g=(0,E.ec)(E.F_.isBusinessWorkspace),y=(0,B.Z)(),b=(0,h._)((0,D.useState)((0,d.Sg)(t)?g?C.Zz.Workspace:C.Zz.Marketplace:t.sharingRecipient),2),j=b[0],_=b[1],w=(0,d.WL)().data,N=(null==w?void 0:w.is_verified)?void 0:y.formatMessage(nM.displayNameRequiredHint);j===C.Zz.Marketplace&&null!=N&&_(C.Zz.Link);var T=g&&!(null===(n=t.allowedSharingRecipients)||void 0===n?void 0:n.some(function(e){return e===C.Zz.Link})),P=eL(t,j),k=P.includes(a.MissingPublicActionPrivacyPolicyURL),z=t.tools.find(function(e){return e.type===x.qK.JIT_PLUGIN&&!e.metadata.privacy_policy_url}),I=(0,E.ec)(function(e){return e.currentWorkspace});return(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{className:"mb-2 text-sm font-medium text-token-text-tertiary",children:(0,u.jsx)(eT.Z,(0,p._)({},nM.publishTo))}),(0,u.jsxs)("div",{className:"flex flex-col gap-3 text-sm",children:[(0,u.jsxs)(Z.fC,{value:j,onValueChange:function(e){return _(e)},className:"space-y-2",children:[t.allowedSharingRecipients&&t.allowedSharingRecipients.map(function(e,n){return(0,u.jsx)(ev.Xb,{value:e,disabled:e===C.Zz.Marketplace&&null!=N,tooltipText:e===C.Zz.Marketplace?null!=N?N:y.formatMessage(nM.publicSharingHint):void 0,label:(0,e$.MI)(e,I,y)},n)}),T&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(ev.Xb,{value:C.Zz.Link,disabled:!0,tooltipText:y.formatMessage(nM.workspaceDisabledHint),label:(0,e$.MI)(C.Zz.Link,I,y)}),(0,u.jsx)(ev.Xb,{value:C.Zz.Marketplace,disabled:!0,tooltipText:y.formatMessage(nM.workspaceDisabledHint),label:(0,e$.MI)(C.Zz.Marketplace,I,y)})]})]}),k&&(0,u.jsx)("div",{className:"text-xs text-red-500",children:(0,u.jsx)(eT.Z,(0,f._)((0,p._)({},nM.actionNeedsPrivacyPolicyURL),{values:{fixlink:function(e){return(0,u.jsx)("button",{onClick:function(){o(null==z?void 0:z.metadata.action_id)},className:"underline",children:e})}}}))}),j!==C.Zz.Private&&(0,u.jsx)(ny.QT,{gizmoAvatar:t.profilePictureUrl,gizmoName:t.name,canEdit:!0}),(0,u.jsx)(ev.cY,{color:"primary",disabled:P.length>0,loading:l,onClick:(0,m._)(function(){var e;return(0,v.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,,2,3]),c(!0),[4,i(j)];case 1:if(null==(e=n.sent()))return[2];return 1===e.gizmo.live_version?q().push((0,d.m_)(e)):r({type:"published",publishedGizmo:e}),[3,3];case 2:return c(!1),[7];case 3:return[2]}})}),className:"w-full",children:(0,u.jsx)(eT.Z,(0,p._)({},nM.privacyConfirm))})]})]})}function n_(e){return"".concat("https://chat.openai.com").concat((0,d.m_)(e))}function nw(e){var n=e.publishedGizmo,t=n_(n);return(0,u.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,u.jsx)("div",{className:"font-medium",children:(0,u.jsx)(eT.Z,(0,p._)({},nM.publishedTitle))}),(0,u.jsxs)("div",{className:"flex gap-1 rounded bg-token-surface-secondary px-2 py-1",children:[(0,u.jsx)("div",{className:"text-ellipsis break-all line-clamp-1",children:t}),(0,u.jsx)("button",{onClick:function(){(0,ng.S)(n_(n))},className:"text-token-text-secondary transition hover:text-token-text-primary",children:(0,u.jsx)(K.dS,{className:"icon-sm"})})]}),(0,u.jsx)(ev.cY,{color:"primary",as:"link",to:t,className:"w-full",children:(0,u.jsx)(eT.Z,(0,p._)({},nM.viewGPT))})]})}function nN(e){var n=e.gizmo,t=e.promoteGizmo,i=e.showActionsModal,r=(0,h._)((0,D.useState)({type:"privacy"}),2),o=r[0],a=r[1];return(0,u.jsx)("div",{className:"w-60 rounded-lg border border-token-border-medium bg-token-surface-primary p-4 text-sm",children:"privacy"===o.type?(0,u.jsx)(nj,{gizmo:n,promoteGizmo:t,setStep:a,showActionsModal:i}):(0,u.jsx)(nw,{publishedGizmo:o.publishedGizmo})})}function nT(e){var n,t=e.gizmo,i=e.isLoading,r=e.isUploadingProfilePic,o=e.isGeneratingProfilePic,s=e.promoteGizmo,l=e.hasUnpublishedChanges,c=e.showActionsModal,m=null!=t?eL(t):[],p=(0,B.Z)();(null==t||i)&&m.push(a.Loading),r&&m.push(a.UploadingProfilePic),o&&m.push(a.GeneratingProfilePic);var f=(0,d.Sg)(t);return(0,u.jsxs)(nh.fC,{modal:!0,children:[(0,u.jsx)(nh.xz,{asChild:!0,children:(0,u.jsx)(ev.cY,{color:"primary",className:"cursor-pointer whitespace-nowrap",disabled:void 0===t.id,tooltip:m.length>0?m.map(eA).join("\n"):void 0,children:(0,u.jsxs)("div",{className:"flex items-center gap-1",children:[l&&!f?p.formatMessage(nM.publishChanges):p.formatMessage(nM.save),(0,u.jsx)(K.ud,{})]})})}),(0,u.jsx)(nh.h_,{children:(0,u.jsx)(nh.VY,{side:"bottom",align:"end",sideOffset:8,children:(0,u.jsx)(nN,{gizmo:t,promoteGizmo:s,showActionsModal:c})})})]})}function nP(e){var n=e.gizmoEditorData,t=e.publishedGizmo,i=e.revertDraft,r=(0,B.Z)(),o=(0,h._)((0,D.useState)(!1),2),a=o[0],s=o[1],l=(0,e7.hz)();return(null==l?void 0:l.includes("debug"))||(null==n?void 0:n.id)!=null?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(ea.fC,{children:[(0,u.jsx)(ea.xz,{asChild:!0,children:(0,u.jsx)(ev.cY,{children:(0,u.jsx)(K.Yr,{className:"icon-md"})})}),(0,u.jsx)(ea.Uv,{children:(0,u.jsxs)(ea.VY,{className:"min-w-[180px] max-w-xs rounded-lg border border-gray-100 bg-token-surface-primary shadow-lg dark:border-gray-700",side:"top",align:"end",sideOffset:6,children:[null!=t&&(0,u.jsxs)(ev.UA,{onClick:function(){(0,ng.S)(n_(t))},children:[(0,u.jsx)(K.HN,{className:"icon-md"}),(0,u.jsx)(eT.Z,(0,p._)({},nM.copyLink))]}),null!=i&&(0,u.jsxs)(ev.UA,{onClick:function(){window.confirm(r.formatMessage(nM.revertConfirm))&&i()},children:[(0,u.jsx)(K.Nt,{className:"icon-md"}),(0,u.jsx)(eT.Z,(0,p._)({},nM.revertMenuItem))]}),(null==l?void 0:l.includes("debug"))&&(0,u.jsxs)(ev.UA,{onClick:function(){e8.vm.toggleActiveSidebar("debug")},children:[(0,u.jsx)(K.WP,{className:"icon-md"}),"Debug (Internal only)"]}),(null==n?void 0:n.id)!=null&&(0,u.jsxs)(ev.UA,{color:"danger",onClick:function(){s(!0)},children:[(0,u.jsx)(K.a_,{className:"icon-md"}),(0,u.jsx)(eT.Z,(0,p._)({},nM.deleteGPT))]})]})})]}),a&&(0,u.jsx)(nf.b,{gizmoId:n.id,onSuccess:function(){q().push((0,U.cy)())},onClose:function(){s(!1)}})]}):null}var nk=T.Z.div(nb());function nz(e){var n=e.gizmoEditorData,t=(0,E.ec)(function(e){var n;return null===(n=e.currentWorkspace)||void 0===n?void 0:n.name});switch(n.sharingRecipient){case C.Zz.Private:return(0,u.jsxs)(nk,{children:[(0,u.jsx)(K.LX,{className:"icon-xs"}),(0,u.jsx)(eT.Z,(0,p._)({},nM.onlyMe))]});case C.Zz.Link:return(0,u.jsxs)(nk,{children:[(0,u.jsx)(K.HN,{className:"icon-xs"}),(0,u.jsx)(eT.Z,(0,p._)({},nM.anyoneWithLink))]});case C.Zz.Workspace:return(0,u.jsxs)(nk,{children:[(0,u.jsx)(K.oq,{className:"icon-xs"}),t]});case C.Zz.Marketplace:return(0,u.jsxs)(nk,{children:[(0,u.jsx)(K.hk,{className:"icon-xs"}),(0,u.jsx)(eT.Z,(0,p._)({},nM.public))]})}return(0,u.jsx)("div",{})}function nC(e){var n=e.gizmoEditorData;return(0,u.jsxs)("div",{className:"flex items-center gap-2",children:[null!=n.profilePictureUrl?(0,u.jsx)(eg.Z,{isFirstParty:!1,src:n.profilePictureUrl,className:"h-8 w-8"}):(0,u.jsx)("div",{className:"h-8 w-8 rounded-full border-2 border-dashed border-token-border-medium"}),(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{className:"text-sm font-medium",children:n.name||(0,u.jsx)(eT.Z,(0,p._)({},nM.newGPT))}),(0,u.jsx)("div",{className:"text-xs text-token-text-secondary",children:(0,d.Sg)(n)?(0,u.jsxs)("div",{className:"flex items-center gap-1",children:[(0,u.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-token-text-tertiary"}),(0,u.jsx)(eT.Z,(0,p._)({},nM.draft))]}):(0,u.jsxs)("div",{className:"flex items-center gap-1",children:[(0,u.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-brand-green"}),(0,u.jsx)(eT.Z,(0,p._)({},nM.published))," \xb7 ",(0,u.jsx)(nz,{gizmoEditorData:n})]})})]})]})}function nI(e){var n=e.gizmoEditorData,t=e.isLoading,i=e.isUploadingProfilePic,r=e.isGeneratingProfilePic,o=e.publishedGizmo,a=e.promoteGizmo,s=e.revertDraft,l=e.draftMessage,c=e.className,d=e.hasUnpublishedChanges,m=e.showActionsModal;return(0,u.jsxs)("div",{className:(0,O.default)("relative flex h-14 w-full items-center justify-between gap-2 border-b border-token-border-medium px-3",c),children:[(0,u.jsxs)("div",{className:"flex items-center gap-2",children:[(0,u.jsx)(nx(),{href:(0,U.cy)(),shallow:!0,className:"text-token-text-primary",children:(0,u.jsx)(K.L7,{className:"icon-lg"})}),(0,u.jsx)(nC,{gizmoEditorData:n})]}),(0,u.jsxs)("div",{className:"flex items-center gap-2",children:[l,(0,u.jsx)(nP,{gizmoEditorData:n,publishedGizmo:o,revertDraft:s}),(0,u.jsx)(nT,{gizmo:n,isLoading:t,isUploadingProfilePic:i,isGeneratingProfilePic:r,promoteGizmo:a,hasUnpublishedChanges:d,showActionsModal:m})]})]})}var nM=(0,$.vU)({privacyConfirm:{id:"gizmo.confirmPublish",defaultMessage:"Confirm",description:"Message prompting you to confirm publication of an action"},workspaceDisabledHint:{id:"gizmo.workspaceDisabledHint",defaultMessage:"Your workspace administrator has disabled this setting",description:"Message saying your workspace administrator isn't allowing something"},publicSharingHint:{id:"gizmo.publicSharingHint",defaultMessage:"This GPT may appear in the GPT Store (coming soon)",description:"Message hinting at what public privacy settings do"},displayNameRequiredHint:{id:"gizmo.displayNameRequiredHint",defaultMessage:"To make your GPT public, set up your builder profile.",description:"Message hinting that you have to setup a builder profile to publish"},save:{id:"gizmo.save",defaultMessage:"Save",description:"Button label for save (publishing)"},publishChanges:{id:"gizmo.publishChanges",defaultMessage:"Update",description:"Button label for publishing changes"},deleteGPT:{id:"gizmo.delete",defaultMessage:"Delete GPT",description:"Button label for deleting a GPT"},actionNeedsPrivacyPolicyURL:{id:"gizmo.actionNeedsPrivacyPolicyURL",defaultMessage:"Public actions require valid privacy policy URLs. Click <fixlink>here</fixlink> to update.",description:"Error message when trying to publish action"},publishTo:{id:"gizmo.publishTo",defaultMessage:"Publish to",description:"Label for above publish options"},publishedTitle:{id:"gizmo.publishedTitle",defaultMessage:"Published!",description:"Popout title when GPT is published"},viewGPT:{id:"gizmo.viewGPT",defaultMessage:"View GPT",description:"Button label for viewing GPT"},revertMenuItem:{id:"gizmo.revertMenuItem",defaultMessage:"Revert...",description:"Menu item for reverting to last saved version"},onlyMe:{id:"gizmo.onlyMe",defaultMessage:"Only me",description:"Privacy option for only me"},anyoneWithLink:{id:"gizmo.anyoneWithLink",defaultMessage:"Anyone with a link",description:"Privacy option for anyone with a link"},public:{id:"gizmo.public",defaultMessage:"Public",description:"Privacy option for public"},newGPT:{id:"gizmo.newGPT",defaultMessage:"New GPT",description:"Placeholder for new GPT name"},draft:{id:"gizmo.draft",defaultMessage:"Draft",description:"Label for draft status"},published:{id:"gizmo.published",defaultMessage:"Published",description:"Label for published status"},revertConfirm:{id:"gizmo.revertConfirm",defaultMessage:"Are you sure you want to revert to the last saved version?",description:"Confirmation message for reverting to last saved version"},copyLink:{id:"gizmo.copyLink",defaultMessage:"Copy link",description:"Menu item for copying link to GPT"}});function nG(e){var n=function(e,n){var t=e.response,i=(0,A.Ot)(e);if(!Array.isArray(t))return i;var r=(0,V.compact)(t.map(function(e){if("value_error.any_str.max_length"===e.type)switch(e.loc[1]){case"display":switch(e.loc[2]){case"name":return n.formatMessage(eY.nameTooLong,{length:e.ctx.limit_value});case"description":return n.formatMessage(eY.descriptionTooLong,{length:e.ctx.limit_value});case"welcome_message":return n.formatMessage(eY.welcomeMessageTooLong,{length:e.ctx.limit_value})}break;case"instructions":return n.formatMessage(eY.instructionsTooLong,{length:e.ctx.limit_value})}if("string"==typeof e.msg)return e.msg}));return r.length>0?r.join("\n"):i}(e.upsertDraftError,(0,B.Z)());return(0,u.jsxs)("div",{className:"flex items-center gap-2 text-red-500",children:[(0,u.jsx)("div",{children:(0,u.jsx)(eT.Z,(0,p._)({},nE.errorSavingDraft))}),null!=n&&(0,u.jsx)(er.u,{label:n,children:(0,u.jsx)(el.H33,{className:"icon-sm"})})]})}function nS(e){var n=e.isSavingDraft,t=e.hasUnpublishedChanges,i=e.upsertDraftError,r=e.className;return i instanceof A.Q0?(0,u.jsx)(nG,{upsertDraftError:i}):t?(0,u.jsxs)("div",{className:(0,O.default)("flex items-center gap-2",r),children:[(0,u.jsx)("span",{className:"text-token-text-secondary",children:"Unpublished changes"}),(0,u.jsx)("div",{className:"w-4 text-token-text-tertiary",children:n&&(0,u.jsx)(I.Z,{})})]}):null}var nE=(0,$.vU)({errorSavingDraft:{id:"gizmo.errorSavingDraft",defaultMessage:"Error saving draft",description:"Error message when saving a draft fails"}}),nA=t(15066);function nL(){return(nL=(0,m._)(function(e){var n,t,i,r,o,a,s,l,c,u,d,m,p,f,h;return(0,v.Jh)(this,function(g){switch(g.label){case 0:t=!0,i=!1,r=void 0;try{for(o=e[Symbol.iterator]();!(t=(a=o.next()).done);t=!0)if(s=a.value,"gizmo_editor.generate_profile_pic"===s.author.name&&"multimodal_text"===s.content.content_type){l=!0,c=!1,u=void 0;try{for(d=s.content.parts[Symbol.iterator]();!(l=(m=d.next()).done);l=!0)p=m.value,"object"==typeof p&&"asset_pointer"in p&&(n=p)}catch(e){c=!0,u=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw u}}}}catch(e){i=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(i)throw r}}if(!(null!=n))return[3,2];return f=(0,eh.Iy)(n.asset_pointer),[4,ej.ZP.getFileDownloadLink(f)];case 1:if((h=g.sent()).status===x.KF.Success)return[2,{id:f,permalink:h.download_url}];g.label=2;case 2:return[2]}})})).apply(this,arguments)}function nU(){return(nU=(0,m._)(function(e,n,t){var i,r,o,a,s,l,c,u,d,m,f,h;return(0,v.Jh)(this,function(g){switch(g.label){case 0:return r=(i=function(e,n){for(var t=S.tQ.getThreadCurrentLeafId(e),i=S.tQ.getTree(e),r=[],o=i.getNodeByIdOrMessageId(t);null!=o&&(null==n||o.id!==n);)r.unshift(o.message),o=""!==o.parentId?i.getNodeByIdOrMessageId(o.parentId):void 0;return r}(n,t)).filter(function(e){return"gizmo_editor.update_behavior"===e.recipient}).flatMap(function(e){return"text"===e.content.content_type?e.content.parts:"code"===e.content.content_type?[e.content.text]:[]}).map(function(e){return JSON.parse(e)}).reduce(function(e,n){return(0,p._)({},e,n)},{}),[4,function(e){return nL.apply(this,arguments)}(i)];case 1:if(o=g.sent(),(0,V.isEmpty)(r)&&null==o)return[2];if(a=r.name,s=r.context,l=r.description,c=r.welcome_message,u=r.profile_pic_file_id,d=r.prompt_starters,!(null!=u))return[3,5];g.label=2;case 2:return g.trys.push([2,4,,5]),[4,ej.ZP.getFileDownloadLink(u,e.id)];case 3:return(m=g.sent()).status===x.KF.Success&&(o={id:u,permalink:m.download_url}),[3,5];case 4:return f=g.sent(),console.error("Error while retrieving profile pic in update: ".concat(f)),M.m.warning("Something went wrong updating your GPT's profile picture.",{duration:3}),[3,5];case 5:return h={name:"string"==typeof a?a:void 0,description:"string"==typeof l?l:void 0,instructions:"string"==typeof s?s:void 0,welcomeMessage:"string"==typeof c?c:void 0,promptStarters:Array.isArray(d)?d:void 0,profilePictureId:null==o?void 0:o.id,profilePictureUrl:null==o?void 0:o.permalink},[2,(0,V.pickBy)(h,function(e){return null!=e})]}})})).apply(this,arguments)}function nD(e,n,t,i){var r,o,a,s,l,c,u,d,m,p,f,h,g,v,x=t.current,y=i.current;if(!(0,V.isEqual)(x,y)){var b={};x.name!==(null==y?void 0:y.name)&&(b.name=x.name),(null!==(a=x.description)&&void 0!==a?a:"")!==(null!==(s=null==y?void 0:y.description)&&void 0!==s?s:"")&&(b.description=null!==(l=x.description)&&void 0!==l?l:""),x.instructions!==(null!==(c=null==y?void 0:y.instructions)&&void 0!==c?c:"")&&(b.context=null!==(u=x.instructions)&&void 0!==u?u:""),(null!==(d=x.welcomeMessage)&&void 0!==d?d:"")!==(null!==(m=null==y?void 0:y.welcomeMessage)&&void 0!==m?m:"")&&(b.welcome_message=null!==(p=x.welcomeMessage)&&void 0!==p?p:"");var j=new Set(null!==(f=null==y?void 0:null===(r=y.files)||void 0===r?void 0:r.map(function(e){return e.file_id}))&&void 0!==f?f:[]),_=new Set(null!==(h=null===(o=x.files)||void 0===o?void 0:o.map(function(e){return e.file_id}))&&void 0!==h?h:[]),w=(null!==(g=x.files)&&void 0!==g?g:[]).filter(function(e){return!j.has(e.file_id)}),N=(null!==(v=null==y?void 0:y.files)&&void 0!==v?v:[]).filter(function(e){return!_.has(e.file_id)});if(!(0,V.isEmpty)(b)||0!==w.length||0!==N.length){var T=[];if(!(0,V.isEmpty)(b)){var P="Explicitly update the GPT's behavior to the following exact fields:\n\n    ".concat(JSON.stringify(b,null,2),'\n\n    "Do not call update_behavior yet. Instead, use these updated fields as the GPT\'s current behavior, and in the next call to update_behavior, incorporate these changes."\n    ');T.push(nA.Cv.getTextAsMessage(P,F.uU.System))}N.length>0&&T.push(nA.Cv.getTextAsMessage("The user has removed the following files from the GPT. You can no longer reference these files: ".concat(N.map(function(e){return e.file_id}).join(", ")),F.uU.System)),w.length>0&&T.push(nA.Cv.getTextAsMessage("The user is adding these files to the GPT. The GPT may reference these files. The file IDs are: ".concat(w.map(function(e){return e.file_id}).join(", ")),F.uU.System,{attachments:w.map(function(e){return{id:e.file_id,name:e.name,size:e.size}})})),T.length>0&&S.tQ.updateTree(e,function(e){var t=e.getNodeByIdOrMessageId(n).parentId,i=!0,r=!1,o=void 0;try{for(var a,s=T[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var l=a.value,c=(0,nn.Z)();e.insertNodeBefore(n,{id:c,children:[],parentId:t,message:l,metadata:{isClientCreatedSystemMessage:!0}}),t=c}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}})}}}var nZ=t(12543),nR=D.memo(function(e){var n=e.gizmoEditorData,t=e.updateGizmo,i=e.clientThreadId,r=e.completionCallbackResponse,o=e.gizmoEditorDataRef,a=e.magicMakerBehaviorOverrides,s=e.magicMakerConversationGizmoEditorDataRef,l=e.requireGizmoId;(0,S.ax)(i);var c=(0,S.UL)(i),d=null==n.id,m=null!=n.id&&""!==n.name&&null!=n.description&&""!==n.instructions&&null!=n.profilePictureUrl,v=(0,h._)((0,D.useState)(d?'Hi! I\'ll help you build a new GPT. You can say something like, "make a creative who helps generate visuals for new products" or "make a software engineer who helps format my code."\n\nWhat would you like to make?':m?"Welcome back! Is there anything ".concat(n.name," should be doing better? Anything you'd like to change?"):"You're back! Let's continue where we left off..."),1)[0];(0,D.useEffect)(function(){S.tQ.getOrInitThread(i);var e=S.tQ.getTree(i);if(!e.findNode(function(e){var n;return e.message.author.role===F.uU.User||(null===(n=e.metadata)||void 0===n?void 0:n.isClientCreatedSystemMessage)===!0})&&(S.tQ.deleteNodesByFilter(i,function(e){var n;return(null===(n=e.metadata)||void 0===n?void 0:n.isPlaceholderTemplateAssistantWelcomeMessage)===!0}),null!=v&&0!==v.length)){var n=S.tQ.getThreadCurrentLeafId(i);if(e.hasNodeOrMessageId(n)){var t=(0,nn.Z)();S.tQ.updateTree(i,function(e){e.addNode(t,v,n,F.uU.Assistant,{isPlaceholderTemplateAssistantWelcomeMessage:!0})}),S.tQ.setThreadCurrentLeafId(i,t)}}},[i,v]),(0,D.useEffect)(function(){(0,S.Zz)(i)&&S.iN.hasThread(i)&&c.lastModelUsed!==eb.Mw&&(S.tQ.getOrInitThread(i),S.tQ.updateInitialThreadDataForNewThread(i,eb.Mw,[]))},[i,c,c.lastModelUsed]);var x=(0,D.useMemo)(function(){return{gizmoEditorData:n,gizmoId:n.id,mode:"magic",behaviorOverrides:a,getGizmoId:l}},[l,n,a]),y=(0,nZ.gF)(function(e){return e.files.filter(function(e){return e.status===ep.X.Ready&&null!=e.gizmoId})}),b=(0,D.useCallback)(function(e,n){var i;!function(e,n,t){if(0!==t.length){var i=(0,nn.Z)(),r="The user is uploading files in their next message. If you need to reference these in calls to update_behavior, you will use the following File ID(s), in order: ".concat(t.map(function(e){return'"'.concat(e.fileId,'"')}).join(", "));S.tQ.updateTree(e,function(e){var t=e.getNodeByIdOrMessageId(n).parentId;e.insertNodeBefore(n,{id:i,children:[],parentId:t,message:nA.Cv.getTextAsMessage(r,F.uU.System),metadata:{isClientCreatedSystemMessage:!0}})})}}(e,n,y),nD(e,n,o,s),function(e,n){for(var t="Remember, you should be calling either update_behavior or generate_profile_pic after most messages from the user. Your personality should be neutral and separate from the GPT you are creating.",i=S.tQ.getThreadCurrentLeafId(e),r=S.tQ.getTree(e),o=r.getNodeByIdOrMessageId(i);null!=o&&o.message.author.role!==F.uU.User;){if("text"===o.message.content.content_type&&o.message.content.parts[0]===t)return;o=""!==o.parentId?r.getNodeByIdOrMessageId(o.parentId):void 0}S.tQ.updateTree(e,function(e){var i=e.getNodeByIdOrMessageId(n).parentId;e.insertNodeBefore(n,{id:(0,nn.Z)(),children:[],parentId:i,message:nA.Cv.getTextAsMessage(t,F.uU.System,{exclude_after_next_user_message:!0}),metadata:{isClientCreatedSystemMessage:!0}})})}(e,n),t(function(e){return(0,f._)((0,p._)({},e),{files:(0,g._)(null!==(i=e.files)&&void 0!==i?i:[]).concat((0,g._)((0,V.compact)(y.map(function(e){var n;return null!=e.fileId&&{file_id:e.fileId,name:e.file.name,size:e.file.size,type:e.file.type,last_modified:e.file.lastModified,file_size_tokens:null===(n=e.fileSpec)||void 0===n?void 0:n.fileTokenSize}}))))})}),s.current=(0,V.cloneDeep)(o.current)},[o,s,y,t]),j=(0,e8.tN)(function(e){return e.activeSidebar});return(0,u.jsx)(ni.D.Provider,{value:x,children:(0,u.jsxs)("div",{className:"relative flex h-full grow overflow-auto",children:[(0,u.jsx)("div",{className:"grow",children:(0,u.jsx)(e4.Z,{initialThreadData:c,clientThreadId:i,onCompletionFinished:r,preRequestCompletion:b,hideHeader:!0,prependThreadChildren:(0,u.jsx)("div",{className:"h-8"})})}),"debug"===j&&(0,u.jsx)(e3.fv,{clientThreadId:i,slideOver:!1,onClose:function(){return e8.vm.toggleActiveSidebar("debug")},isOpen:!0})]})})});function nO(e){var n=e.value,t=e.label;return(0,u.jsx)(Z.ck,{value:n,className:"text-md w-1/3 flex-grow rounded-lg border-token-border-light p-1.5 font-medium text-token-text-tertiary transition hover:text-token-text-primary radix-state-checked:border radix-state-checked:bg-token-surface-primary radix-state-checked:text-token-text-primary radix-state-checked:shadow-[0_0_2px_rgba(0,0,0,.03)] radix-state-checked:dark:bg-token-surface-secondary md:w-1/2",children:t})}function nV(e){var n=e.className,t=e.editorTab,i=e.setEditorTab;return(0,u.jsxs)(Z.fC,{className:(0,O.default)("flex w-full overflow-hidden rounded-xl bg-token-surface-secondary p-1.5 dark:bg-token-surface-tertiary md:w-1/2",n),value:t,onValueChange:function(e){i(e)},children:[(0,u.jsx)(nO,{value:c.MAGIC_MAKER,label:"Create"}),(0,u.jsx)(nO,{value:c.ADVANCED,label:"Configure"}),(0,u.jsx)("div",{className:"flex w-1/3 md:hidden",children:(0,u.jsx)(nO,{value:c.PREVIEW,label:"Preview"})})]})}(o=c||(c={})).MAGIC_MAKER="magic",o.ADVANCED="advanced",o.PREVIEW="preview";var nJ={id:void 0,instructions:"",name:"",description:"",profilePictureId:void 0,profilePictureUrl:void 0,welcomeMessage:"",promptStarters:[],tools:[{type:x.qK.DALLE}],files:[],trainingDisabled:!1,liveVersion:0},nq=(0,f._)((0,p._)({},nJ),{tools:(0,g._)(nJ.tools).concat([{type:x.qK.BROWSER}])});function nB(e){var n,t,i,r,o,a;return{id:e.gizmo.id,instructions:e.gizmo.instructions,name:e.gizmo.display.name,description:null!==(n=e.gizmo.display.description)&&void 0!==n?n:"",profilePictureId:void 0,profilePictureUrl:null!==(t=e.gizmo.display.profile_picture_url)&&void 0!==t?t:void 0,welcomeMessage:null!==(i=e.gizmo.display.welcome_message)&&void 0!==i?i:"",promptStarters:null!==(r=e.gizmo.display.prompt_starters)&&void 0!==r?r:[],tools:e.tools,files:e.files,trainingDisabled:null!==(o=e.gizmo.training_disabled)&&void 0!==o&&o,sharingRecipient:e.gizmo.share_recipient,allowedSharingRecipients:e.gizmo.allowed_sharing_recipients,liveVersion:null!==(a=e.gizmo.live_version)&&void 0!==a?a:0}}var nW=function(e){var n,t,i,r,o,a,s,l,g,x,b,j,_=e.gizmo,N=e.onNewGizmoId,T=function(e){var n,t,i="function"==typeof e?e(I.current):(n=I.current,null==(t=e)?n:(t=function e(n){return"object"==typeof n&&null!=n?Array.isArray(n)?n.map(e):Object.fromEntries(Object.entries(n).map(function(n){var t=(0,h._)(n,2);return[t[0],e(t[1])]})):null===n?void 0:n}(t),(0,p._)({},n,t)));(0,V.isEqual)(i,I.current)||(I.current=i,J(I.current),er())},P=(0,y.C)(G.L0.BrowseAvailable),k=(0,B.Z)(),I=(0,D.useRef)(null!=_?nB(_):P?nq:nJ),E=(0,D.useRef)(_),L=(0,D.useRef)(I.current),U=(0,h._)((0,D.useState)(function(){return I.current}),2),Z=U[0],J=U[1],q=(0,h._)((0,D.useState)(function(){return(0,S.OX)()}),2),W=q[0];q[1];var H=(0,d.kg)(I.current.id).data,K=(0,d.N_)(),Q=K.isPending,X=K.error,Y=(0,d.ZJ)(),$=(0,D.useMemo)(function(){var e,n,t,i,r,o;return null!=H&&(!(Z.name===H.gizmo.display.name&&Z.description===H.gizmo.display.description&&Z.welcomeMessage===H.gizmo.display.welcome_message&&Z.instructions===H.gizmo.instructions&&(r=Z.tools,o=H.tools,r.length===o.length&&r.every(function(e){return o.some(function(n){return n.type===e.type})}))&&(0,V.isEqual)(null!==(t=null===(e=Z.files)||void 0===e?void 0:e.map(function(e){return e.file_id}))&&void 0!==t?t:[],null!==(i=null===(n=H.files)||void 0===n?void 0:n.map(function(e){return e.file_id}))&&void 0!==i?i:[]))||Z.profilePictureUrl!=H.gizmo.display.profile_picture_url)},[Z,H]),ee=(null===(j=null==_?void 0:_.gizmo.appeal_info)||void 0===j?void 0:j.state.kind)==="appeal_sent",en=(n=(0,m._)(function(){var e,n,t,i,r,o;return(0,v.Jh)(this,function(a){switch(a.label){case 0:e=I.current,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,K.mutateAsync({editorData:e,gizmoId:e.id})];case 2:return n=a.sent(),E.current=n,null==I.current.id&&(t=n.gizmo.id,I.current=(0,f._)((0,p._)({},I.current),{id:t,allowedSharingRecipients:n.gizmo.allowed_sharing_recipients}),J(I.current),null==N||N(t)),[2,n];case 3:throw i=a.sent(),o=null!==(r=(0,A.Ot)(i))&&void 0!==r?r:k.formatMessage(nE.errorSavingDraft),M.m.warning(o,{duration:2}),i;case 4:return[2]}})}),function(){return n.apply(this,arguments)}),et=(0,D.useRef)(),ei=(t=(0,m._)(function(){return(0,v.Jh)(this,function(e){return null!=I.current.id?[2,I.current.id]:(null==et.current&&(et.current=en().then(function(e){return e.gizmo.id}).catch(function(e){throw et.current=void 0,e})),[2,et.current])})}),function(){return t.apply(this,arguments)}),er=(0,h._)((0,D.useState)(function(){return(0,V.debounce)(function(){return en()},2e3,{trailing:!0})}),1)[0],eo=(0,h._)((0,D.useState)(function(){return{context_message:function(e){var n,t,i,r,o=new Set,a=!0,s=!1,l=void 0;try{for(var c,u=e.tools[Symbol.iterator]();!(a=(c=u.next()).done);a=!0){var d=c.value;o.add(d.type)}}catch(e){s=!0,l=e}finally{try{a||null==u.return||u.return()}finally{if(s)throw l}}var m=null!==(n=e.name)&&void 0!==n?n:"",p=null!==(t=e.description)&&void 0!==t?t:"",f=null!==(i=e.instructions)&&void 0!==i?i:"",h=Array.from(o).join(","),g=null!==(r=e.welcomeMessage)&&void 0!==r?r:"",v=null!=e.profilePictureUrl;return""===m&&""===p&&""===f&&""===g?"The GPT you are about to has the following abilities: ".concat(h,"."):"This is the GPT's current set of fields:\n\nname: ".concat(m,"\n\ndescription: ").concat(p,"\n\ncontext: ").concat(f,"\n\nabilities: ").concat(h,"\n\nwelcome_message: ").concat(g,"\n\n").concat(v?"The GPT has a profile picture.":"This GPT does not have a profile picture. You must generate a profile picture when you next update your behavior.","\n")}(I.current),model_slug:"unused",enabled_tools:[{tool_id:null!=_?"gizmo_editor":"gizmo_creator"}]}}),1)[0],ea=(0,D.useRef)(),es=(i=(0,m._)(function(e){var n;return(0,v.Jh)(this,function(t){switch(t.label){case 0:if(null==e)return eI(!1),[2];t.label=1;case 1:return t.trys.push([1,3,4,5]),[4,function(e,n,t){return nU.apply(this,arguments)}(I.current,e,ea.current)];case 2:return null!=(n=t.sent())&&(T(n),L.current=(0,V.cloneDeep)(I.current)),[3,5];case 3:return console.error(t.sent()),M.m.warning("Something went wrong generating your GPT",{duration:3}),[3,5];case 4:return ea.current=S.tQ.getThreadCurrentLeafId(e),eI(!1),[7];case 5:return[2]}})}),function(e){return i.apply(this,arguments)}),el=(r=(0,nt.Z)(W,void 0,V.noop,V.noop,es,[]),o=(0,e7.hz)(),a=(0,m._)(function(e,n,t){var i,a,s,l,c,u,d,m,p,f,h,g,x;return(0,v.Jh)(this,function(v){switch(v.label){case 0:if(0===t.length)return[2];i=S.tQ.getThreadCurrentLeafId(W),a=!0,s=!1,l=void 0;try{for(c=t[Symbol.iterator]();!(a=(u=c.next()).done);a=!0)d=u.value,m=(0,nn.Z)(),S.tQ.updateTree(W,function(e){e.addNodeToEnd(i,{id:m,children:[],parentId:i,message:nA.Cv.getTextAsMessage(d,F.uU.System),metadata:{isClientCreatedSystemMessage:!0}})}),S.tQ.setThreadCurrentLeafId(W,m),i=m}catch(e){s=!0,l=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw l}}if(p=i,nD(W,p,e,n),f={conversationMode:{kind:F.OL.GizmoMagicCreate,gizmo_id:e.current.id,behavior_overrides:eo}},h=[eb.S.GPT_4],g=(0,ne.Rr)(o,h,F.OL.GizmoMagicCreate),x=null,!g)return[3,2];return[4,ne.ZP.getEnforcementToken(h)];case 1:x=v.sent(),v.label=2;case 2:return r({model:eb.Mw,completionType:F.Os.Next,parentNodeId:p,metadata:{},focusOnNewCompletion:!0,arkoseToken:x,preflightTime:0,completionMetadata:f,extraStreamParams:{}}),[2]}})}),function(e,n,t){return a.apply(this,arguments)}),ec=(0,h._)((0,D.useState)(!1),2),eu=ec[0],ed=ec[1],em=(0,h._)((0,D.useState)(!1),2),ep=em[0],ef=em[1],eh=(0,h._)((0,D.useState)(void 0),2),eg=eh[0],ev=eh[1],ex=(s=(0,m._)(function(e){var n,t,i,r;return(0,v.Jh)(this,function(o){switch(o.label){case 0:if((n=eL(I.current,e)).length>0)return M.m.warning("Could not save GPT:\n\n".concat(n.map(function(e){return"- ".concat(eA(e))}).join("\n")),{duration:3}),[2];return[4,en()];case 1:i=(t=o.sent()).gizmo.id,o.label=2;case 2:return o.trys.push([2,4,,5]),ev({gizmoId:i,sharingRecipient:e}),[4,Y.mutateAsync({gizmoId:t.gizmo.id,data:{sharingRecipient:e}},{onSuccess:function(e){R.E.setQueryData((0,d.Vw)(i).queryKey,e),R.E.invalidateQueries({queryKey:["gizmos"]}),R.E.invalidateQueries({queryKey:["gizmo",{gizmoId:i}]}),R.E.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:i}]})}})];case 3:return[2,o.sent()];case 4:return(r=o.sent())instanceof C.DC?(ed(!!r.response.is_flagged_brand_name),ef(!0)):(console.error(r),M.m.warning("Error saving GPT",{duration:2})),[3,5];case 5:return[2]}})}),function(e){return s.apply(this,arguments)}),ey=K.isPending||Y.isPending,ej=(0,h._)((0,D.useState)(c.MAGIC_MAKER),2),e_=ej[0],ew=ej[1],eN=(g=(l=(0,h._)((0,D.useState)({width:null,height:null}),2))[0],x=l[1],(0,D.useLayoutEffect)(function(){var e=function(){x({width:window.innerWidth,height:window.innerHeight})};return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}},[]),g).width;(0,D.useEffect)(function(){null!=eN&&eN>=768&&e_===c.PREVIEW&&ew(c.MAGIC_MAKER)},[eN,e_]);var eT=(0,h._)((0,D.useState)(!1),2),eP=eT[0],ek=eT[1],ez=(0,h._)((0,D.useState)(!1),2),eC=ez[0],eI=ez[1],eM=(0,h._)((0,D.useState)(void 0),2),eG=eM[0],eS=eM[1];return(0,u.jsxs)("div",{className:"flex h-screen w-full flex-col items-center",children:[(0,u.jsx)(nI,{gizmoEditorData:Z,isLoading:ey,hasUnpublishedChanges:$,isUploadingProfilePic:eP,isGeneratingProfilePic:eC,publishedGizmo:H,promoteGizmo:(b=(0,m._)(function(e){var n;return(0,v.Jh)(this,function(t){switch(t.label){case 0:return[4,ex(e)];case 1:return n=t.sent(),I.current=(0,f._)((0,p._)({},I.current),{sharingRecipient:e}),J(I.current),[2,n]}})}),function(e){return b.apply(this,arguments)}),revertDraft:null!=H&&$?function(){var e=R.E.getQueryData((0,d.Vw)(I.current.id).queryKey);if(null!=e){var n=nB(e);I.current=n,J(n),en()}}:void 0,draftMessage:(0,u.jsx)(nS,{hasUnpublishedChanges:$,isSavingDraft:Q,upsertDraftError:X,className:"text-sm"}),showActionsModal:function(e){eS(e)},className:"flex-shrink-0"}),ee&&_&&(0,u.jsx)(w,{gizmoId:_.gizmo.id}),ep&&eg&&(0,u.jsx)(z,{isFlaggedBrandName:eu,onClose:function(){return ef(!1)}}),(0,u.jsxs)("div",{className:"relative flex w-full grow overflow-hidden",children:[(0,u.jsx)("div",{className:"flex w-full justify-center md:w-1/2",children:(0,u.jsx)("div",{className:"h-full grow overflow-hidden",children:void 0!==eG?(0,u.jsx)(np,{currentlyEditingActionDomain:eG,gizmoEditorData:Z,updateGizmo:T,onClose:function(){eS(void 0)}}):(0,u.jsxs)("div",{className:"flex h-full flex-col px-2 pt-2",children:[(0,u.jsx)(nV,{editorTab:e_,setEditorTab:ew,className:"mb-2 flex-shrink-0 self-center"}),(0,u.jsx)("div",{className:"grow overflow-hidden",children:e_===c.MAGIC_MAKER?(0,u.jsx)("div",{className:"h-full w-full pb-5",children:(0,u.jsx)(nR,{gizmoEditorData:Z,updateGizmo:T,completionCallbackResponse:es,clientThreadId:W,gizmoEditorDataRef:I,magicMakerBehaviorOverrides:eo,magicMakerConversationGizmoEditorDataRef:L,requireGizmoId:ei},W)}):e_===c.ADVANCED?(0,u.jsx)(eX,{gizmoEditorData:Z,updateGizmo:T,generateProfilePic:function(){eI(!0),el(I,L,["Generate a new profile picture for this GPT using gizmo_editor generate_profile_pic. Do not prompt the user for any clarification. Do not send extra text outside of the tool function call. Do not call update_behavior in your next message."])},setIsUploadingProfilePic:ek,isGeneratingProfilePic:eC,setIsGeneratingProfilePic:eI,requireGizmoId:ei,onShowActionsEditor:function(e){eS(e)}}):(0,u.jsx)(ns,{gizmoEditorData:Z,isSavingDraft:Q,showTitle:!1})})]})})}),(0,u.jsx)("div",{className:(0,O.default)("hidden w-1/2 justify-center border-l border-token-border-medium bg-token-surface-secondary pt-4",e_!==c.PREVIEW&&"md:flex"),children:(0,u.jsx)("div",{className:"flex-grow pb-5",children:(0,u.jsx)("div",{className:"h-full",children:(0,u.jsx)(ns,{gizmoEditorData:Z,isSavingDraft:Q})})})})]})]})};function nF(e){var n=e.businessWorkspaceId,t=e.gizmoId,i=(0,d.b9)(t,!0).data,r=(0,E.ec)(E.F_.accountUserId),o=(0,E.aF)(),a=null==o?void 0:o.id,s=null!=i&&null!=r&&null!=a&&(0,e$.k1)(i,r,a,n);return null!=i&&s?(0,u.jsx)(nW,{gizmo:i}):null}function nH(e){var n=e.onNewGizmoId;return(0,u.jsx)(nW,{gizmo:void 0,onNewGizmoId:n})}function nK(e){var n=e.gizmoId,t=e.remixSourceId,i=(0,J.useRouter)(),r=(0,E.$T)(),o=(0,E.ec)(E.F_.businessWorkspaceId),a=(0,D.useRef)(void 0),s=n;return null!=n&&a.current===n&&(s=void 0),(0,L.yx)({resetThreadAction:function(){i.push("/")}}),(0,u.jsx)("div",{children:r?(0,u.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,u.jsx)(I.Z,{})}):(0,u.jsx)("div",{children:void 0!=s?(0,u.jsx)(nF,{businessWorkspaceId:o,gizmoId:s},s):(0,u.jsx)(nH,{remixSourceId:t,onNewGizmoId:function(e){a.current=e,window.history.replaceState(window.history.state,"",(0,U.AA)(e))}})})})}var nQ=t(23234),nX=t(18866),nY=!0;function n$(){var e,n=(0,nQ.J)();e=null==n||n,(0,D.useEffect)(function(){e||q().replace((0,nX.M5)(nX.LT.NO_ACCESS),void 0,{shallow:!0})},[e]);var t=(0,J.useRouter)(),i=t.query.slug,r=i?(0,d.CR)(i):void 0,o=t.query.remixFrom,a=(0,E.$T)(),s=(0,e7.hz)(),l=null==s?void 0:s.includes(G.PL),c=(0,nQ.J)();return((0,D.useEffect)(function(){l&&ne.ZP.initializeAndGatherData()},[l]),(0,D.useEffect)(function(){a||c||t.push("/")},[a,s,t,c]),c)?(0,u.jsx)(nK,{gizmoId:r,remixSourceId:o}):null}},81547:function(e,n,t){t.d(n,{b:function(){return u}});var i=t(21722),r=t(38104),o=t(35250),a=t(94705),s=t(7184),l=t(21950),c=t(72290);function u(e){var n,t=e.gizmoId,u=e.onSuccess,d=e.onClose,m=(0,l.kb)(),p=(n=(0,i._)(function(){return(0,r.Jh)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,m.mutateAsync({gizmoId:t})];case 1:return e.sent(),u(),[3,3];case 2:return e.sent(),c.m.danger("Failed to delete gizmo. Please try again."),[3,3];case 3:return[2]}})}),function(){return n.apply(this,arguments)});return(0,o.jsx)(s.Z,{isOpen:!0,onClose:d,type:"danger",title:"Delete GPT",primaryButton:(0,o.jsx)(a.ZP.Button,{title:"Delete GPT",color:"danger",loading:m.isPending,onClick:function(){p()}}),secondaryButton:(0,o.jsx)(a.ZP.Button,{title:"Cancel",color:"neutral",onClick:d}),children:(0,o.jsx)("div",{className:"text-sm",children:"Are you sure you want to delete this GPT? This cannot be undone."})})}}}]);